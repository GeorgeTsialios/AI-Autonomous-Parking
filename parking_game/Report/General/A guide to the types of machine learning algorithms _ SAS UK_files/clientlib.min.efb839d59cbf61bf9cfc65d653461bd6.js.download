jQuery(document).ready(function(){var c=jQuery("div.oktaauth"),d=window.location.origin+window.location.pathname,e=jQuery("div.oktalogout");new URLSearchParams(window.location.search);var b=d.split("/").pop().split(".")[0];if(1===e.size())document.cookie="oktasession\x3d;expires\x3dThu, 01 Jan 1970 00:00:00 UTC;path\x3d/",sessionStorage.removeItem(b+"AccessToken"),localStorage.removeItem(b+"AccessToken"),e=e.attr("data-ssohost"),window.parent.postMessage("token-removed-"+window.location.href,e),localStorage.removeItem(b+
"AccessExpiry"),sessionStorage.removeItem(b+"AccessExpiry");else if(1===c.size()){var k=c.attr("data-okta-auth-url"),n=c.attr("data-clientid");e=c.attr("data-scopes").split(",");var l=c.attr("data-ssohost");c=new OktaAuth({url:k,issuer:k,responseMode:"fragment",pkce:!0,clientId:n,redirectUri:d});d=sessionStorage.getItem(b+"AccessToken");(null==d||c.token.decode(d).payload.exp<=Date.now())&&c.token.getWithoutPrompt({responseType:"id_token",scopes:e}).then(function(f){f=f.tokens.accessToken.accessToken;
if("undefined"!==typeof Storage){var a=new Date;a.setHours(a.getHours()+1);sessionStorage.setItem(b+"AccessToken",f);localStorage.setItem(b+"AccessToken",f);sessionStorage.setItem(b+"AccessExpiry","T"+a.getTime());localStorage.setItem(b+"AccessExpiry","T"+a.getTime());"okta"===b&&(document.cookie="oktasession\x3dtrue;path\x3d/;Secure;SameSite\x3dNone");window.parent.postMessage("token-success-"+window.location.href+"-"+a.getTime(),l)}}).catch(function(f){console.log(f);sessionStorage.removeItem(b+
"AccessToken");sessionStorage.removeItem(b+"AccessExpiry");window.parent.postMessage("token-error-"+window.location.href,l)});d&&localStorage.setItem("emailAddress",btoa(c.token.decode(d).payload.sub))}else{var m=jQuery("iframe.oktaframe");if(0<m.size()&&0<=d.indexOf("okta.sso")){var g=0,h=0;window.addEventListener("message",function(b){console.log(b.data);g++},!1);var p=setInterval(function(){h++;if(g>=m.size()||50<h){clearInterval(p);50<h&&console.log("timeout intervalcounter - message count: "+
g);var b=sessionStorage.getItem("returnurl"),a=null,c=new URLSearchParams(window.location.search);if(c.has("returnurl")){a=c.get("returnurl");c=null;try{c=new URL(a)}catch(q){console.log("return was not a url: "+a),a="https://www.sas.com"}null===c||c.hostname.endsWith(".sas.com")||c.hostname.endsWith(".jmp.com")||(console.log("return was not an approved url 1: "+a),a="https://www.sas.com");0>a.indexOf(".sas.com")&&0>a.indexOf(".jmp.com")&&(console.log("return was not an approved url 2: "+a),a="https://www.sas.com");
0<=a.toLowerCase().indexOf("script:")&&(console.log("return contained a possible xss attack: "+a),a="https://www.sas.com")}console.log("return from session ("+b+") - return from url ("+a+")");null===b&&null===a&&history.go(-2);window.location.href=a?a:b}},250)}}});
/*__ESM_BODY_START__*/
var jt=Object.create,Jn=Object.defineProperty;var er=Object.getOwnPropertyDescriptor;var nr=Object.getOwnPropertyNames;var tr=Object.getPrototypeOf,rr=Object.prototype.hasOwnProperty;var ir=t=>Jn(t,"__esModule",{value:!0});var te=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var ar=(t,r,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let C of nr(r))!rr.call(t,C)&&C!=="default"&&Jn(t,C,{get:()=>r[C],enumerable:!(i=er(r,C))||i.enumerable});return t},sr=t=>ar(ir(Jn(t!=null?jt(tr(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Se=te(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.default=Oe.WEBSOCKET_TYPE_NAME=Oe.TOKEN_MANAGEMENT_EXTENSION=void 0;var or={servletPath:"amb",logLevel:"info",loginWindow:"true",wsConnectTimeout:1e4,overlayStyle:"",pruneFailedTransports:"true",subscribeCommandsFlow:{enable:!1,maxInflight:1,maxWait:1e4,retries:3,retryDelay:{min:2e3,max:3e5,increaseFactor:2}},redeliveryDisconnectTimeoutInMins:10,requestHeaderToClearStickySessionCookie:!0},ur="websocket";Oe.WEBSOCKET_TYPE_NAME=ur;var cr="tokenManagementExtension";Oe.TOKEN_MANAGEMENT_EXTENSION=cr;var lr=or;Oe.default=lr});var oe=te(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.default=void 0;var dr=fr(Se());function fr(t){return t&&t.__esModule?t:{default:t}}var gr=function(r){function i(C){window.console&&console.log(r+" "+C)}return{debug:function(y){dr.default.logLevel==="debug"&&i("[DEBUG] "+y)},addInfoMessage:function(y){i("[INFO] "+y)},addErrorMessage:function(y){i("[ERROR] "+y)},addWarnMessage:function(y){i("[WARN] "+y)}}},hr=gr;gn.default=hr});var Zn=te(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.default=void 0;var vr=function(r){var i=[],C=0;return{subscribe:function(o,S){var d=C++;return i.push({event:o,callback:S,id:d}),d},unsubscribe:function(o){for(var S=0;S<i.length;S++)o===i[S].id&&i.splice(S,1)},publish:function(o,S){for(var d=this._getSubscriptions(o),c=0;c<d.length;c++)d[c].callback.apply(null,S)},getEvents:function(){return r},_getSubscriptions:function(o){for(var S=[],d=0;d<i.length;d++)i[d].event===o&&S.push(i[d]);return S}}},br=vr;hn.default=br});var bn=te(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.default=void 0;var pr=_r(oe());function _r(t){return t&&t.__esModule?t:{default:t}}var mr=function(r,i,C){var y,o,S=new pr.default("amb.ChannelListener"),d=r;return{getCallback:function(){return o},getSubscriptionCallback:function(){return C},getID:function(){return y},setNewChannel:function(l){d.unsubscribe(this),d=l,this.subscribe(o)},subscribe:function(l){return o=l,y=d.subscribe(this),this},resubscribe:function(){return this.subscribe(o)},unsubscribe:function(){return d.unsubscribe(this),S.debug("Unsubscribed from channel: "+d.getName()),this},publish:function(l,k){d.publish(l,k)},getName:function(){return d.getName()}}},Cr=mr;vn.default=Cr});var $n=te(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.default=void 0;var Sr=ht(oe()),Er=ht(bn());function ht(t){return t&&t.__esModule?t:{default:t}}var Tr=function(r,i){var C,y=r,o=new Sr.default("amb.ChannelRedirect");function S(c,l){for(var k=c.getChannelListeners(),m=0;m<k.length;m++){var D=k[m];D.setNewChannel(l)}}function d(c){o.debug("_onAdvice:"+c.data.clientId);var l=i.getChannels(),k=l!=null?l[c.data.fromChannel]:null;if(!k){var m=i.getRemovedChannels();k=m!=null?m[c.data.fromChannel]:null}var D=i.getChannel(c.data.toChannel);if(!k||!D){o.debug("Could not redirect from "+c.data.fromChannel+" to "+c.data.toChannel);return}S(k,D),o.debug("published channel switch event, fromChannel:"+k.getName()+", toChannel:"+D.getName())}return{initialize:function(l){var k="/sn/meta/channel_redirect/"+y.getClientId(),m=i.getChannel(k);!C||m!==C?(C&&i.removeChannel(C.getName()),C=m,new Er.default(C,i,l).subscribe(d)):C.subscribeToCometD(),o.debug("ChannelRedirect initialized: "+k)},_onAdvice:d}},yr=Tr;_n.default=yr});var pn=te(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.isUndefined=de.isObject=de.isNull=de.isNil=de.isEmptyObject=void 0;function jn(t){return jn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},jn(t)}var vt=function(r){return r===void 0};de.isUndefined=vt;var bt=function(r){return r===null};de.isNull=bt;var xr=function(r){return bt(r)||vt(r)};de.isNil=xr;var _t=function(r){return r!=null&&jn(r)==="object"};de.isObject=_t;var wr=function(r){return _t(r)&&Object.keys(r).length===0};de.isEmptyObject=wr});var mt=te((et,pt)=>{(function(t,r){typeof et=="object"?pt.exports=r():typeof define=="function"&&define.amd?define([],r):(t.org=t.org||{},t.org.cometd=r())})(et,function(){var t=function(){var E=0,T={};this.register=function(n){var f=++E;return T[f]=n,f},this.unregister=function(n){var f=T[n];return delete T[n],f},this.setTimeout=function(n,f){return window.setTimeout(n,f)},this.clearTimeout=function(n){window.clearTimeout(n)}};function r(){var E={};self.onmessage=function(T){var n=T.data,f=E[n.id];switch(n.type){case"setTimeout":E[n.id]=self.setTimeout(function(){delete E[n.id],self.postMessage({id:n.id})},n.delay);break;case"clearTimeout":delete E[n.id],f&&self.clearTimeout(f);break;default:throw"Unknown command "+n.type}}}var i={isString:function(E){return E==null?!1:typeof E=="string"||E instanceof String},isArray:function(E){return E==null?!1:E instanceof Array},inArray:function(E,T){for(var n=0;n<T.length;++n)if(E===T[n])return n;return-1}},C=function(){var E=[],T={};this.getTransportTypes=function(){return E.slice(0)},this.findTransportTypes=function(n,f,b){for(var a=[],g=0;g<E.length;++g){var I=E[g];T[I].accept(n,f,b)===!0&&a.push(I)}return a},this.negotiateTransport=function(n,f,b,a){for(var g=0;g<E.length;++g)for(var I=E[g],x=0;x<n.length;++x)if(I===n[x]){var w=T[I];if(w.accept(f,b,a)===!0)return w}return null},this.add=function(n,f,b){for(var a=!1,g=0;g<E.length;++g)if(E[g]===n){a=!0;break}return a||(typeof b!="number"?E.push(n):E.splice(b,0,n),T[n]=f),!a},this.find=function(n){for(var f=0;f<E.length;++f)if(E[f]===n)return T[n];return null},this.remove=function(n){for(var f=0;f<E.length;++f)if(E[f]===n){E.splice(f,1);var b=T[n];return delete T[n],b}return null},this.clear=function(){E=[],T={}},this.reset=function(n){for(var f=0;f<E.length;++f)T[E[f]].reset(n)}},y=function(){var E,T,n;this.registered=function(f,b){E=f,T=b},this.unregistered=function(){E=null,T=null},this._notifyTransportTimeout=function(f){var b=T._getTransportListeners("timeout");if(b)for(var a=0;a<b.length;++a){var g=b[a];try{var I=g.call(this,f);if(typeof I=="number"&&I>0)return I}catch(x){this._info("Exception during execution of transport listener",g,x)}}return 0},this._debug=function(){T._debug.apply(T,arguments)},this._info=function(){T._info.apply(T,arguments)},this._mixin=function(){return T._mixin.apply(T,arguments)},this.getConfiguration=function(){return T.getConfiguration()},this.getAdvice=function(){return T.getAdvice()},this.setTimeout=function(f,b){return T.setTimeout(f,b)},this.clearTimeout=function(f){T.clearTimeout(f)},this.convertToJSON=function(f){for(var b=this.getConfiguration().maxSendBayeuxMessageSize,a="[",g=0;g<f.length;++g){g>0&&(a+=",");var I=f[g],x=JSON.stringify(I);if(x.length>b)throw"maxSendBayeuxMessageSize "+b+" exceeded";a+=x}return a+="]",a},this.convertToMessages=function(f){if(i.isString(f))try{return JSON.parse(f)}catch(b){throw this._debug("Could not convert to JSON the following string",'"'+f+'"'),b}if(i.isArray(f))return f;if(f==null)return[];if(f instanceof Object)return[f];throw"Conversion Error "+f+", typeof "+typeof f},this.accept=function(f,b,a){throw"Abstract"},this.getType=function(){return E},this.getURL=function(){return n},this.setURL=function(f){n=f},this.send=function(f,b){throw"Abstract"},this.reset=function(f){this._debug("Transport",E,"reset",f?"initial":"retry")},this.abort=function(){this._debug("Transport",E,"aborted")},this.toString=function(){return this.getType()}};y.derive=function(E){function T(){}return T.prototype=E,new T};var o=function(){var E=new y,T=y.derive(E),n=0,f=null,b=[],a=[];function g(A){for(;a.length>0;){var h=a[0],N=h[0],U=h[1];if(N.url===A.url&&N.sync===A.sync){a.shift(),A.messages=A.messages.concat(N.messages),this._debug("Coalesced",N.messages.length,"messages from request",U.id);continue}break}}function I(A,h,N){var U=this._notifyTransportTimeout(A.messages);if(U>0){this._debug("Transport",this.getType(),"extended waiting for message replies of request",h.id,":",U,"ms");var K=this;h.timeout=this.setTimeout(function(){I.call(K,A,h,N+U)},U)}else{h.expired=!0;var _="Transport "+this.getType()+" expired waiting for message replies of request "+h.id+": "+N+" ms",R={reason:_},q=h.xhr;R.httpCode=this.xhrStatus(q),this.abortXHR(q),this._debug(_),this.complete(h,!1,h.metaConnect),A.onFailure(q,A.messages,R)}}function x(A,h){if(this.transportSend(A,h)&&(h.expired=!1,!A.sync)){var N=this.getConfiguration().maxNetworkDelay;h.metaConnect===!0&&(N+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"started waiting for message replies of request",h.id,":",N,"ms");var U=this;h.timeout=this.setTimeout(function(){I.call(U,A,h,N)},N)}}function w(A){var h=++n,N={id:h,metaConnect:!1,envelope:A};b.length<this.getConfiguration().maxConnections-1?(b.push(N),x.call(this,A,N)):(this._debug("Transport",this.getType(),"queueing request",h,"envelope",A),a.push([A,N]))}function L(A){var h=A.id;if(this._debug("Transport",this.getType(),"/meta/connect complete, request",h),f!==null&&f.id!==h)throw"/meta/connect request mismatch, completing request "+h;f=null}function M(A,h){var N=i.inArray(A,b);if(N>=0&&b.splice(N,1),a.length>0){var U=a.shift(),K=U[0],_=U[1];if(this._debug("Transport dequeued request",_.id),h)this.getConfiguration().autoBatch&&g.call(this,K),w.call(this,K),this._debug("Transport completed request",A.id,K);else{var R=this;this.setTimeout(function(){R.complete(_,!1,_.metaConnect);var q={reason:"Previous request failed"},F=_.xhr;q.httpCode=R.xhrStatus(F),K.onFailure(F,K.messages,q)},0)}}}T.complete=function(A,h,N){N?L.call(this,A):M.call(this,A,h)},T.transportSend=function(A,h){throw"Abstract"},T.transportSuccess=function(A,h,N){h.expired||(this.clearTimeout(h.timeout),this._debug("Transport",this.getType(),"cancelled waiting for message replies"),this.complete(h,!0,h.metaConnect),N&&N.length>0?A.onSuccess(N):A.onFailure(h.xhr,A.messages,{httpCode:204}))},T.transportFailure=function(A,h,N){h.expired||(this.clearTimeout(h.timeout),this._debug("Transport",this.getType(),"cancelled waiting for failed message replies"),this.complete(h,!1,h.metaConnect),A.onFailure(h.xhr,A.messages,N))};function P(A){if(f!==null)throw"Concurrent /meta/connect requests not allowed, request id="+f.id+" not yet completed";var h=++n;this._debug("Transport",this.getType(),"/meta/connect send, request",h,"envelope",A);var N={id:h,metaConnect:!0,envelope:A};x.call(this,A,N),f=N}return T.send=function(A,h){h?P.call(this,A):w.call(this,A)},T.abort=function(){E.abort();for(var A=0;A<b.length;++A){var h=b[A];h&&(this._debug("Aborting request",h),this.abortXHR(h.xhr)||this.transportFailure(h.envelope,h,{reason:"abort"}))}var N=f;N&&(this._debug("Aborting /meta/connect request",N),this.abortXHR(N.xhr)||this.transportFailure(N.envelope,N,{reason:"abort"})),this.reset(!0)},T.reset=function(A){E.reset(A),f=null,b=[],a=[]},T.abortXHR=function(A){if(A)try{var h=A.readyState;return A.abort(),h!==window.XMLHttpRequest.UNSENT}catch(N){this._debug(N)}return!1},T.xhrStatus=function(A){if(A)try{return A.status}catch(h){this._debug(h)}return-1},T},S=function(){var E=new o,T=y.derive(E),n=!0;T.accept=function(b,a,g){return n||!a},T.newXMLHttpRequest=function(){return new window.XMLHttpRequest};function f(b){try{b.context=T.context}catch(a){T._debug("Could not copy transport context into XHR",a)}}return T.xhrSend=function(b){var a=T.newXMLHttpRequest();f(a),a.withCredentials=!0,a.open("POST",b.url,b.sync!==!0);var g=b.headers;if(g)for(var I in g)g.hasOwnProperty(I)&&a.setRequestHeader(I,g[I]);return a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onload=function(){a.status===200?b.onSuccess(a.responseText):b.onError(a.statusText)},a.onabort=a.onerror=function(){b.onError(a.statusText)},a.send(b.body),a},T.transportSend=function(b,a){this._debug("Transport",this.getType(),"sending request",a.id,"envelope",b);var g=this;try{var I=!0;return a.xhr=this.xhrSend({transport:this,url:b.url,sync:b.sync,headers:this.getConfiguration().requestHeaders,body:this.convertToJSON(b.messages),onSuccess:function(x){g._debug("Transport",g.getType(),"received response",x);var w=!1;try{var L=g.convertToMessages(x);L.length===0?(n=!1,g.transportFailure(b,a,{httpCode:204})):(w=!0,g.transportSuccess(b,a,L))}catch(P){if(g._debug(P),!w){n=!1;var M={exception:P};M.httpCode=g.xhrStatus(a.xhr),g.transportFailure(b,a,M)}}},onError:function(x,w){g._debug("Transport",g.getType(),"received error",x,w),n=!1;var L={reason:x,exception:w};L.httpCode=g.xhrStatus(a.xhr),I?g.setTimeout(function(){g.transportFailure(b,a,L)},0):g.transportFailure(b,a,L)}}),I=!1,!0}catch(x){return this._debug("Transport",this.getType(),"exception:",x),n=!1,this.setTimeout(function(){g.transportFailure(b,a,{exception:x})},0),!1}},T.reset=function(b){E.reset(b),n=!0},T},d=function(){var E=new o,T=y.derive(E),n=0;T.accept=function(b,a,g){return!0},T.jsonpSend=function(b){var a=document.getElementsByTagName("head")[0],g=document.createElement("script"),I="_cometd_jsonp_"+n++;window[I]=function(w){a.removeChild(g),delete window[I],b.onSuccess(w)};var x=b.url;x+=x.indexOf("?")<0?"?":"&",x+="jsonp="+I,x+="&message="+encodeURIComponent(b.body),g.src=x,g.async=b.sync!==!0,g.type="application/javascript",g.onerror=function(w){b.onError("jsonp "+w.type)},a.appendChild(g)};function f(b,a,g){var I=this;return function(){I.transportFailure(b,a,"error",g)}}return T.transportSend=function(b,a){for(var g=this,I=0,x=b.messages.length,w=[];x>0;){var L=JSON.stringify(b.messages.slice(I,I+x)),M=b.url.length+encodeURI(L).length,P=this.getConfiguration().maxURILength;if(M>P){if(x===1){var A="Bayeux message too big ("+M+" bytes, max is "+P+") for transport "+this.getType();this.setTimeout(f.call(this,b,a,A),0);return}--x;continue}w.push(x),I+=x,x=b.messages.length-I}var h=b;if(w.length>1){var N=0,U=w[0];this._debug("Transport",this.getType(),"split",b.messages.length,"messages into",w.join(" + ")),h=this._mixin(!1,{},b),h.messages=b.messages.slice(N,U),h.onSuccess=b.onSuccess,h.onFailure=b.onFailure;for(var K=1;K<w.length;++K){var _=this._mixin(!1,{},b);N=U,U+=w[K],_.messages=b.messages.slice(N,U),_.onSuccess=b.onSuccess,_.onFailure=b.onFailure,this.send(_,a.metaConnect)}}this._debug("Transport",this.getType(),"sending request",a.id,"envelope",h);try{var R=!0;return this.jsonpSend({transport:this,url:h.url,sync:h.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(h.messages),onSuccess:function(q){var F=!1;try{var z=g.convertToMessages(q);z.length===0?g.transportFailure(h,a,{httpCode:204}):(F=!0,g.transportSuccess(h,a,z))}catch(Z){g._debug(Z),F||g.transportFailure(h,a,{exception:Z})}},onError:function(q,F){var z={reason:q,exception:F};R?g.setTimeout(function(){g.transportFailure(h,a,z)},0):g.transportFailure(h,a,z)}}),R=!1,!0}catch(q){return this.setTimeout(function(){g.transportFailure(h,a,{exception:q})},0),!1}},T},c=function(){var E=new y,T=y.derive(E),n,f=!0,b=!1,a=!0,g=null,I=null,x=!1,w=null;T.reset=function(_){E.reset(_),f=!0,_&&(b=!1),a=!0,_&&(g=null),I=null,x=!1};function L(_,R){_&&(this.webSocketClose(_,R.code,R.reason),this.onClose(_,R))}function M(_){return _===I||_===g}function P(_,R,q){for(var F=[],z=0;z<R.messages.length;++z){var Z=R.messages[z];Z.id&&F.push(Z.id)}_.envelopes[F.join(",")]=[R,q],this._debug("Transport",this.getType(),"stored envelope, envelopes",_.envelopes)}function A(_,R){for(var q=!1,F=_.envelopes,z=0;z<R.length;++z){var Z=R[z];for(var X in F)if(F.hasOwnProperty(X)){var ne=X.split(","),J=i.inArray(Z,ne);if(J>=0){q=!0,ne.splice(J,1);var ue=F[X][0],se=F[X][1];delete F[X],ne.length>0&&(F[ne.join(",")]=[ue,se]);break}}}q&&this._debug("Transport",this.getType(),"removed envelope, envelopes",F)}function h(_){if(!I){var R=n.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",R);try{var q=n.getConfiguration().protocol;_.webSocket=q?new window.WebSocket(R,q):new window.WebSocket(R),I=_}catch(J){throw f=!1,this._debug("Exception while creating WebSocket object",J),J}a=n.getConfiguration().stickyReconnect!==!1;var F=this,z=n.getConfiguration().connectTimeout;z>0&&(_.connectTimer=this.setTimeout(function(){n._debug("Transport",F.getType(),"timed out while connecting to URL",R,":",z,"ms"),L.call(F,_,{code:1e3,reason:"Connect Timeout"})},z));var Z=function(){n._debug("WebSocket onopen",_),_.connectTimer&&F.clearTimeout(_.connectTimer),M(_)?(I=null,g=_,b=!0,F.onOpen(_)):(n._warn("Closing extra WebSocket connection",this,"active connection",g),L.call(F,_,{code:1e3,reason:"Extra Connection"}))},X=function(J){J=J||{code:1e3},n._debug("WebSocket onclose",_,J,"connecting",I,"current",g),_.connectTimer&&F.clearTimeout(_.connectTimer),F.onClose(_,J)},ne=function(J){n._debug("WebSocket onmessage",J,_),F.onMessage(_,J)};_.webSocket.onopen=Z,_.webSocket.onclose=X,_.webSocket.onerror=function(){X({code:1e3,reason:"Error"})},_.webSocket.onmessage=ne,this._debug("Transport",this.getType(),"configured callbacks on",_)}}function N(_,R,q){var F=this._notifyTransportTimeout([R]);if(F>0){this._debug("Transport",this.getType(),"extended waiting for message replies:",F,"ms");var z=this;_.timeouts[R.id]=this.setTimeout(function(){N.call(z,_,R,q+F)},F)}else this._debug("Transport",this.getType(),"expired waiting for message reply",R.id,":",q,"ms"),L.call(this,_,{code:1e3,reason:"Message Timeout"})}function U(_,R,q){var F=this;try{var z=this.convertToJSON(R.messages)}catch(H){this._debug("Transport",this.getType(),"exception:",H);for(var Z=[],X=0;X<R.messages.length;++X){var ne=R.messages[X];Z.push(ne.id)}A.call(this,_,Z),this.setTimeout(function(){F._notifyFailure(R.onFailure,_,R.messages,{exception:H})},0);return}_.webSocket.send(z),this._debug("Transport",this.getType(),"sent",R,"/meta/connect =",q);var J=this.getConfiguration().maxNetworkDelay;q&&(J+=this.getAdvice().timeout,x=!0);for(var ue=[],se=0;se<R.messages.length;++se)(function(){var H=R.messages[se];H.id&&(ue.push(H.id),_.timeouts[H.id]=F.setTimeout(function(){N.call(F,_,H,J)},J))})();this._debug("Transport",this.getType(),"started waiting for message replies",J,"ms, messageIds:",ue,", timeouts:",_.timeouts)}T._notifySuccess=function(_,R){_.call(this,R)},T._notifyFailure=function(_,R,q,F){_.call(this,R,q,F)};function K(_,R,q){try{_===null?(_=I||{envelopes:{},timeouts:{}},P.call(this,_,R,q),h.call(this,_)):(P.call(this,_,R,q),U.call(this,_,R,q))}catch(z){var F=this;this.setTimeout(function(){L.call(F,_,{code:1e3,reason:"Exception",exception:z})},0)}}return T.onOpen=function(_){var R=_.envelopes;this._debug("Transport",this.getType(),"opened",_,"pending messages",R);for(var q in R)if(R.hasOwnProperty(q)){var F=R[q],z=F[0],Z=F[1];w=z.onSuccess,U.call(this,_,z,Z)}},T.onMessage=function(_,R){this._debug("Transport",this.getType(),"received websocket message",R,_);for(var q=!1,F=this.convertToMessages(R.data),z=[],Z=0;Z<F.length;++Z){var X=F[Z];if((/^\/meta\//.test(X.channel)||X.data===void 0)&&X.id){z.push(X.id);var ne=_.timeouts[X.id];ne&&(this.clearTimeout(ne),delete _.timeouts[X.id],this._debug("Transport",this.getType(),"removed timeout for message",X.id,", timeouts",_.timeouts))}X.channel==="/meta/connect"&&(x=!1),X.channel==="/meta/disconnect"&&!x&&(q=!0)}A.call(this,_,z),this._notifySuccess(w,F),q&&this.webSocketClose(_,1e3,"Disconnect")},T.onClose=function(_,R){this._debug("Transport",this.getType(),"closed",_,R),M(_)&&(f=a&&b,I=null,g=null);var q=_.timeouts;_.timeouts={};for(var F in q)q.hasOwnProperty(F)&&this.clearTimeout(q[F]);var z=_.envelopes;_.envelopes={};for(var Z in z)if(z.hasOwnProperty(Z)){var X=z[Z][0],ne=z[Z][1];ne&&(x=!1);var J={websocketCode:R.code,reason:R.reason};R.exception&&(J.exception=R.exception),this._notifyFailure(X.onFailure,_,X.messages,J)}},T.registered=function(_,R){E.registered(_,R),n=R},T.accept=function(_,R,q){return this._debug("Transport",this.getType(),"accept, supported:",f),f&&!!window.WebSocket&&n.websocketEnabled!==!1},T.send=function(_,R){this._debug("Transport",this.getType(),"sending",_,"/meta/connect =",R),K.call(this,g,_,R)},T.webSocketClose=function(_,R,q){try{_.webSocket&&_.webSocket.close(R,q)}catch(F){this._debug(F)}},T.abort=function(){E.abort(),L.call(this,g,{code:1e3,reason:"Abort"}),this.reset(!0)},T},l=function(E){var T=new t,n=this,f=E||"default",b=!1,a=new C,g,I="disconnected",x=0,w=null,L=0,M=[],P=!1,A=0,h={},N={},U=0,K=null,_=[],R={},q,F,z={},Z={},X=!1,ne=!1,J=0,ue=0,se=null,H={useWorkerScheduler:!0,protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,urls:{},maxURILength:2e3,maxSendBayeuxMessageSize:8192,advice:{timeout:6e4,interval:0,reconnect:void 0,maxInterval:0}};function We(e,s){try{return e[s]}catch(u){return}}this._mixin=function(e,s,u){for(var p=s||{},O=2;O<arguments.length;++O){var G=arguments[O];if(G!=null){for(var W in G)if(G.hasOwnProperty(W)){var Q=We(G,W),j=We(p,W);if(Q===s||Q===void 0)continue;if(e&&typeof Q=="object"&&Q!==null)if(Q instanceof Array)p[W]=this._mixin(e,j instanceof Array?j:[],Q);else{var he=typeof j=="object"&&!(j instanceof Array)?j:{};p[W]=this._mixin(e,he,Q)}else p[W]=Q}}}return p};function be(e){return i.isString(e)}function Fe(e){return e>="A"&&e<="Z"?!0:e>="a"&&e<="z"}function Un(e){return e>="0"&&e<="9"}function ze(e){switch(e){case" ":case"!":case"#":case"$":case"(":case")":case"*":case"+":case"-":case".":case"/":case"@":case"_":case"{":case"~":case"}":return!0;default:return!1}}function Qe(e){if(!be(e)||e.length<2||e.charAt(0)!=="/")return!1;for(var s=1;s<e.length;++s){var u=e.charAt(s);if(!(Fe(u)||Un(u)||ze(u)))return!1}return!0}function V(e){return e==null?!1:typeof e=="function"}function Re(e,s){for(var u="";--s>0&&!(e>=Math.pow(10,s));)u+="0";return u+=e,u}function Ue(e,s){if(window.console){var u=window.console[e];if(V(u)){var p=new Date;[].splice.call(s,0,0,Re(p.getHours(),2)+":"+Re(p.getMinutes(),2)+":"+Re(p.getSeconds(),2)+"."+Re(p.getMilliseconds(),3)),u.apply(window.console,s)}}}this._warn=function(){Ue("warn",arguments)},this._info=function(){H.logLevel!=="warn"&&Ue("info",arguments)},this._debug=function(){H.logLevel==="debug"&&Ue("debug",arguments)};function _e(e){return new RegExp("(^https?://)?(((\\[[^\\]]+])|([^:/?#]+))(:(\\d+))?)?([^?#]*)(.*)?").exec(e)}this._isCrossDomain=function(e){return window.location&&window.location.host&&e?e!==window.location.host:!1};function qn(e){n._debug("Configuring cometd object with",e),be(e)&&(e={url:e}),e||(e={}),H=n._mixin(!1,H,e);var s=n.getURL();if(!s)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var u=_e(s),p=u[2],O=u[8],G=u[9];if(b=n._isCrossDomain(p),H.appendMessageTypeToURL)if(G!==void 0&&G.length>0)n._info("Appending message type to URI "+O+G+" is not supported, disabling 'appendMessageTypeToURL' configuration"),H.appendMessageTypeToURL=!1;else{var W=O.split("/"),Q=W.length-1;O.match(/\/$/)&&(Q-=1),W[Q].indexOf(".")>=0&&(n._info("Appending message type to URI "+O+" is not supported, disabling 'appendMessageTypeToURL' configuration"),H.appendMessageTypeToURL=!1)}if(window.Worker&&window.Blob&&window.URL&&H.useWorkerScheduler){var j=r.toString();j=j.substring(j.indexOf("{")+1,j.lastIndexOf("}"));var he=new window.Blob([j],{type:"application/json"}),we=window.URL.createObjectURL(he),Ce=new window.Worker(we);T.setTimeout=function(ve,Pe){var Ge=T.register(ve);return Ce.postMessage({id:Ge,type:"setTimeout",delay:Pe}),Ge},T.clearTimeout=function(ve){T.unregister(ve),Ce.postMessage({id:ve,type:"clearTimeout"})},Ce.onmessage=function(ve){var Pe=ve.data.id,Ge=T.unregister(Pe);Ge&&Ge()}}}function en(e){if(e){var s=h[e.channel];s&&s[e.id]&&(delete s[e.id],n._debug("Removed",e.listener?"listener":"subscription",e))}}function nn(e){e&&!e.listener&&en(e)}function tn(){for(var e in h)if(h.hasOwnProperty(e)){var s=h[e];if(s)for(var u in s)s.hasOwnProperty(u)&&nn(s[u])}}function ce(e){I!==e&&(n._debug("Status",I,"->",e),I=e)}function ae(){return I==="disconnecting"||I==="disconnected"}function le(){var e=++x;return""+e}function rn(e,s,u,p,O){try{return s.call(e,p)}catch(W){var G=n.onExtensionException;if(V(G)){n._debug("Invoking extension exception handler",u,W);try{G.call(n,W,u,O,p)}catch(Q){n._info("Exception during execution of extension exception handler",u,Q)}}else n._info("Exception during execution of extension",u,W);return p}}function Hn(e){for(var s=0;s<_.length&&e!=null;++s){var u=_[s],p=u.extension.incoming;if(V(p)){var O=rn(u.extension,p,u.name,e,!1);e=O===void 0?e:O}}return e}function an(e){for(var s=_.length-1;s>=0&&e!=null;--s){var u=_[s],p=u.extension.outgoing;if(V(p)){var O=rn(u.extension,p,u.name,e,!0);e=O===void 0?e:O}}return e}function qe(e,s){var u=h[e];if(u){for(var p in u)if(u.hasOwnProperty(p)){var O=u[p];if(O)try{O.callback.call(O.scope,s)}catch(W){var G=n.onListenerException;if(V(G)){n._debug("Invoking listener exception handler",O,W);try{G.call(n,W,O,O.listener,s)}catch(Q){n._info("Exception during execution of listener exception handler",O,Q)}}else n._info("Exception during execution of listener",O,s,W)}}}}function re(e,s){qe(e,s);for(var u=e.split("/"),p=u.length-1,O=p;O>0;--O){var G=u.slice(0,O).join("/")+"/*";O===p&&qe(G,s),G+="*",qe(G,s)}}function sn(){K!==null&&n.clearTimeout(K),K=null}function Ve(e,s){sn();var u=R.interval+s;n._debug("Function scheduled in",u,"ms, interval =",R.interval,"backoff =",U,e),K=n.setTimeout(e,u)}var on,Ye;function Le(e,s,u){for(var p=0;p<e.length;++p){var O=e[p],G=O.id;w&&(O.clientId=w),O=an(O),O!=null?(O.id=G,e[p]=O):(delete z[G],e.splice(p--,1))}if(e.length!==0){s&&(se=e[0]);var W=n.getURL();H.appendMessageTypeToURL&&(W.match(/\/$/)||(W=W+"/"),u&&(W=W+u));var Q={url:W,sync:!1,messages:e,onSuccess:function(j){try{on.call(n,j)}catch(he){n._info("Exception during handling of messages",he)}},onFailure:function(j,he,we){try{var Ce=n.getTransport();we.connectionType=Ce?Ce.getType():"unknown",Ye.call(n,j,he,we)}catch(ve){n._info("Exception during handling of failure",ve)}}};n._debug("Send",Q),g.send(Q,s)}}function De(e){L>0||P===!0?M.push(e):Le([e],!1)}this.send=De;function ye(){U=0}function Pn(){return U<H.maxBackoff&&(U+=H.backoffIncrement),U}function Wn(){++L,n._debug("Starting batch, depth",L)}function un(){var e=M;M=[],e.length>0&&Le(e,!1)}function zn(){if(--L,n._debug("Ending batch, depth",L),L<0)throw"Calls to startBatch() and endBatch() are not paired";L===0&&!ae()&&!P&&un()}function Qn(){if(!ae()){var e={id:le(),channel:"/meta/connect",connectionType:g.getType()};ne||(e.advice={timeout:0}),ce("connecting"),n._debug("Connect sent",e),Le([e],!0,"connect"),ce("connected")}}function xe(e){ce("connecting"),Ve(function(){Qn()},e)}function cn(e){e&&(R=n._mixin(!1,{},H.advice,e),n._debug("New advice",R))}function ke(e){if(sn(),e&&g&&g.abort(),b=!1,g=null,ce("disconnected"),w=null,L=0,ye(),X=!1,ne=!1,J=0,se=null,M.length>0){var s=M;M=[],Ye.call(n,void 0,s,{reason:"Disconnected"})}}function Ke(e,s,u){var p=n.onTransportException;if(V(p)){n._debug("Invoking transport exception handler",e,s,u);try{p.call(n,u,e,s)}catch(O){n._info("Exception during execution of transport exception handler",O)}}}function Xe(e,s){V(e)&&(s=e,e=void 0),w=null,tn(),ae()&&a.reset(!0),cn({}),L=0,P=!0,q=e,F=s;var u="1.0",p=n.getURL(),O=a.findTransportTypes(u,b,p),G={id:le(),version:u,minimumVersion:u,channel:"/meta/handshake",supportedConnectionTypes:O,advice:{timeout:R.timeout,interval:R.interval}},W=n._mixin(!1,{},q,G);if(n._putCallback(W.id,s),!g&&(g=a.negotiateTransport(O,u,b,p),!g)){var Q="Could not find initial transport among: "+a.getTransportTypes();throw n._warn(Q),Q}n._debug("Initial transport is",g.getType()),ce("handshaking"),n._debug("Handshake sent",W),Le([W],!1,"handshake")}function Vn(e){ce("handshaking"),P=!0,Ve(function(){Xe(q,F)},e)}function He(e,s){try{e.call(n,s)}catch(p){var u=n.onCallbackException;if(V(u)){n._debug("Invoking callback exception handler",p);try{u.call(n,p,s)}catch(O){n._info("Exception during execution of callback exception handler",O)}}else n._info("Exception during execution of message callback",p)}}this._getCallback=function(e){return z[e]},this._putCallback=function(e,s){var u=this._getCallback(e);return V(s)&&(z[e]=s),u};function fe(e){var s=n._getCallback([e.id]);V(s)&&(delete z[e.id],He(s,e))}function ln(e){var s=Z[e.id];if(delete Z[e.id],s){n._debug("Handling remote call response for",e,"with context",s);var u=s.timeout;u&&n.clearTimeout(u);var p=s.callback;if(V(p))return He(p,e),!0}return!1}this.onTransportFailure=function(e,s,u){this._debug("Transport failure",s,"for",e);var p=this.getTransportRegistry(),O=this.getURL(),G=this._isCrossDomain(_e(O)[2]),W="1.0",Q=p.findTransportTypes(W,G,O);if(s.action==="none"){if(e.channel==="/meta/handshake"&&!s.transport){var j="Could not negotiate transport, client=["+Q+"], server=["+e.supportedConnectionTypes+"]";this._warn(j),Ke(g.getType(),null,{reason:j,connectionType:g.getType(),transport:g})}}else if(s.delay=this.getBackoffPeriod(),e.channel==="/meta/handshake"){if(!s.transport){var he=g?g.getType():null,we=p.negotiateTransport(Q,W,G,O);if(!we)this._warn("Could not negotiate transport, client=["+Q+"]"),Ke(he,null,e.failure),s.action="none";else{var Ce=we.getType();this._debug("Transport",he,"->",Ce),Ke(he,Ce,e.failure),s.action="handshake",s.transport=we}}s.action!=="none"&&this.increaseBackoffPeriod()}else{var ve=new Date().getTime();if(J===0&&(J=ve),s.action==="retry"){s.delay=this.increaseBackoffPeriod();var Pe=R.maxInterval;if(Pe>0){var Ge=R.timeout+R.interval+Pe,$t=ve-J;$t+U>Ge&&(s.action="handshake")}}s.action==="handshake"&&(s.delay=0,p.reset(!1),this.resetBackoffPeriod())}u.call(n,s)};function Je(e){n._debug("Transport failure handling",e),e.transport&&(g=e.transport),e.url&&g.setURL(e.url);var s=e.action,u=e.delay||0;switch(s){case"handshake":Vn(u);break;case"retry":xe(u);break;case"none":ke(!0);break;default:throw"Unknown action "+s}}function Ze(e,s){fe(e),re("/meta/handshake",e),re("/meta/unsuccessful",e),ae()&&(s.action="none"),n.onTransportFailure.call(n,e,s,Je)}function fn(e){var s=n.getURL();if(e.successful){var u=n._isCrossDomain(_e(s)[2]),p=a.negotiateTransport(e.supportedConnectionTypes,e.version,u,s);if(p===null){e.successful=!1,Ze(e,{cause:"negotiation",action:"none",transport:null});return}else g!==p&&(n._debug("Transport",g.getType(),"->",p.getType()),g=p);w=e.clientId,P=!1,un(),e.reestablish=X,X=!0,fe(e),re("/meta/handshake",e),ue=e["x-messages"]||0;var O=ae()?"none":R.reconnect||"retry";switch(O){case"retry":ye(),ue===0?xe(0):n._debug("Processing",ue,"handshake-delivered messages");break;case"none":ke(!0);break;default:throw"Unrecognized advice action "+O}}else Ze(e,{cause:"unsuccessful",action:R.reconnect||"handshake",transport:g})}function Yn(e){Ze(e,{cause:"failure",action:"handshake",transport:null})}function ge(e){return I==="disconnected"?!0:se&&se.id===e.id?(se=null,!0):!1}function dn(e,s){re("/meta/connect",e),re("/meta/unsuccessful",e),ae()&&(s.action="none"),n.onTransportFailure.call(n,e,s,Je)}function Kn(e){if(ge(e))if(ne=e.successful,ne){re("/meta/connect",e);var s=ae()?"none":R.reconnect||"retry";switch(s){case"retry":ye(),xe(U);break;case"none":ke(!1);break;default:throw"Unrecognized advice action "+s}}else dn(e,{cause:"unsuccessful",action:R.reconnect||"retry",transport:g});else n._debug("Mismatched /meta/connect reply",e)}function $e(e){ge(e)?(ne=!1,dn(e,{cause:"failure",action:"retry",transport:null})):n._debug("Mismatched /meta/connect failure",e)}function v(e){ke(!0),fe(e),re("/meta/disconnect",e),re("/meta/unsuccessful",e)}function B(e){e.successful?(ke(!1),fe(e),re("/meta/disconnect",e)):v(e)}function Y(e){v(e)}function ee(e){var s=h[e.subscription];if(s){for(var u in s)if(s.hasOwnProperty(u)){var p=s[u];p&&!p.listener&&(delete s[u],n._debug("Removed failed subscription",p))}}fe(e),re("/meta/subscribe",e),re("/meta/unsuccessful",e)}function Ae(e){e.successful?(fe(e),re("/meta/subscribe",e)):ee(e)}function Yt(e){ee(e)}function ct(e){fe(e),re("/meta/unsubscribe",e),re("/meta/unsuccessful",e)}function Kt(e){e.successful?(fe(e),re("/meta/unsubscribe",e)):ct(e)}function Xt(e){ct(e)}function Xn(e){ln(e)||(fe(e),re("/meta/publish",e),re("/meta/unsuccessful",e))}function Jt(e){e.data!==void 0?ln(e)||(re(e.channel,e),ue>0&&(--ue,ue===0&&(n._debug("Processed last handshake-delivered message"),xe(0)))):e.successful===void 0?n._warn("Unknown Bayeux Message",e):e.successful?(fe(e),re("/meta/publish",e)):Xn(e)}function Zt(e){Xn(e)}function lt(e){if(J=0,e=Hn(e),e!=null){cn(e.advice);var s=e.channel;switch(s){case"/meta/handshake":fn(e);break;case"/meta/connect":Kn(e);break;case"/meta/disconnect":B(e);break;case"/meta/subscribe":Ae(e);break;case"/meta/unsubscribe":Kt(e);break;default:Jt(e);break}}}this.receive=lt,on=function(e){n._debug("Received",e);for(var s=0;s<e.length;++s){var u=e[s];lt(u)}},Ye=function(e,s,u){n._debug("handleFailure",e,s,u),u.transport=e;for(var p=0;p<s.length;++p){var O=s[p],G={id:O.id,successful:!1,channel:O.channel,failure:u};switch(u.message=O,O.channel){case"/meta/handshake":Yn(G);break;case"/meta/connect":$e(G);break;case"/meta/disconnect":Y(G);break;case"/meta/subscribe":G.subscription=O.subscription,Yt(G);break;case"/meta/unsubscribe":G.subscription=O.subscription,Xt(G);break;default:Zt(G);break}}};function ft(e){var s=h[e];if(s){for(var u in s)if(s.hasOwnProperty(u)&&s[u])return!0}return!1}function dt(e,s){var u={scope:e,method:s};if(V(e))u.scope=void 0,u.method=e;else if(be(s)){if(!e)throw"Invalid scope "+e;if(u.method=e[s],!V(u.method))throw"Invalid callback "+s+" for scope "+e}else if(!V(s))throw"Invalid callback "+s;return u}function gt(e,s,u,p){var O=dt(s,u);n._debug("Adding",p?"listener":"subscription","on",e,"with scope",O.scope,"and callback",O.method);var G=++A,W={id:G,channel:e,scope:O.scope,callback:O.method,listener:p},Q=h[e];return Q||(Q={},h[e]=Q),Q[G]=W,n._debug("Added",p?"listener":"subscription",W),W}this.registerTransport=function(e,s,u){var p=a.add(e,s,u);return p&&(this._debug("Registered transport",e),V(s.registered)&&s.registered(e,this)),p},this.unregisterTransport=function(e){var s=a.remove(e);return s!==null&&(this._debug("Unregistered transport",e),V(s.unregistered)&&s.unregistered()),s},this.unregisterTransports=function(){a.clear()},this.getTransportTypes=function(){return a.getTransportTypes()},this.findTransport=function(e){return a.find(e)},this.getTransportRegistry=function(){return a},this.configure=function(e){qn.call(this,e)},this.init=function(e,s){this.configure(e),this.handshake(s)},this.handshake=function(e,s){if(I!=="disconnected")throw"Illegal state: handshaken";Xe(e,s)},this.disconnect=function(e,s){if(!ae()){V(e)&&(s=e,e=void 0);var u={id:le(),channel:"/meta/disconnect"},p=this._mixin(!1,{},e,u);n._putCallback(p.id,s),ce("disconnecting"),Le([p],!1,"disconnect")}},this.startBatch=function(){Wn()},this.endBatch=function(){zn()},this.batch=function(e,s){var u=dt(e,s);this.startBatch();try{u.method.call(u.scope),this.endBatch()}catch(p){throw this._info("Exception during execution of batch",p),this.endBatch(),p}},this.addTransportListener=function(e,s){if(e!=="timeout")throw"Unsupported event "+e;var u=N[e];u||(N[e]=u=[]),u.push(s)},this.removeTransportListener=function(e,s){var u=N[e];if(u){var p=u.indexOf(s);if(p>=0)return u.splice(p,1),!0}return!1},this._getTransportListeners=function(e){return N[e]},this.addListener=function(e,s,u){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!be(e))throw"Illegal argument type: channel must be a string";return gt(e,s,u,!0)},this.removeListener=function(e){if(!e||!e.channel||!("id"in e))throw"Invalid argument: expected subscription, not "+e;en(e)},this.clearListeners=function(){h={}},this.subscribe=function(e,s,u,p,O){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!Qe(e))throw"Illegal argument: invalid channel "+e;if(ae())throw"Illegal state: disconnected";V(s)&&(O=p,p=u,u=s,s=void 0),V(p)&&(O=p,p=void 0);var G=!ft(e),W=gt(e,s,u,!1);if(G){var Q={id:le(),channel:"/meta/subscribe",subscription:e},j=this._mixin(!1,{},p,Q);n._putCallback(j.id,O),De(j)}else V(O)&&n.setTimeout(function(){He(O,{id:le(),successful:!0,channel:"/meta/subscribe",subscription:e})},0);return W},this.unsubscribe=function(e,s,u){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(ae())throw"Illegal state: disconnected";V(s)&&(u=s,s=void 0),this.removeListener(e);var p=e.channel;if(ft(p))V(u)&&n.setTimeout(function(){He(u,{id:le(),successful:!0,channel:"/meta/unsubscribe",subscription:p})},0);else{var O={id:le(),channel:"/meta/unsubscribe",subscription:p},G=this._mixin(!1,{},s,O);n._putCallback(G.id,u),De(G)}},this.resubscribe=function(e,s){if(nn(e),e)return this.subscribe(e.channel,e.scope,e.callback,s)},this.clearSubscriptions=function(){tn()},this.publish=function(e,s,u,p){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!Qe(e))throw"Illegal argument: invalid channel "+e;if(/^\/meta\//.test(e))throw"Illegal argument: cannot publish to meta channels";if(ae())throw"Illegal state: disconnected";V(s)?(p=s,s={},u=void 0):V(u)&&(p=u,u=void 0);var O={id:le(),channel:e,data:s},G=this._mixin(!1,{},u,O);n._putCallback(G.id,p),De(G)},this.publishBinary=function(e,s,u,p,O,G){V(s)?(G=s,s=new ArrayBuffer(0),u=!0,p=void 0,O=void 0):V(u)?(G=u,u=!0,p=void 0,O=void 0):V(p)?(G=p,p=void 0,O=void 0):V(O)&&(G=O,O=void 0);var W={meta:p,data:s,last:u},Q=this._mixin(!1,O,{ext:{binary:{}}});this.publish(e,W,Q,G)},this.remoteCall=function(e,s,u,p,O){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!be(e))throw"Illegal argument type: target must be a string";if(ae())throw"Illegal state: disconnected";if(V(s)?(O=s,s={},u=H.maxNetworkDelay,p=void 0):V(u)?(O=u,u=H.maxNetworkDelay,p=void 0):V(p)&&(O=p,p=void 0),typeof u!="number")throw"Illegal argument type: timeout must be a number";e.match(/^\//)||(e="/"+e);var G="/service"+e;if(!Qe(G))throw"Illegal argument: invalid target "+e;var W={id:le(),channel:G,data:s},Q=this._mixin(!1,{},p,W),j={callback:O};u>0&&(j.timeout=n.setTimeout(function(){n._debug("Timing out remote call",Q,"after",u,"ms"),Xn({id:Q.id,error:"406::timeout",successful:!1,failure:{message:Q,reason:"Remote Call Timeout"}})},u),n._debug("Scheduled remote call timeout",Q,"in",u,"ms")),Z[Q.id]=j,De(Q)},this.remoteCallBinary=function(e,s,u,p,O,G,W){V(s)?(W=s,s=new ArrayBuffer(0),u=!0,p=void 0,O=H.maxNetworkDelay,G=void 0):V(u)?(W=u,u=!0,p=void 0,O=H.maxNetworkDelay,G=void 0):V(p)?(W=p,p=void 0,O=H.maxNetworkDelay,G=void 0):V(O)?(W=O,O=H.maxNetworkDelay,G=void 0):V(G)&&(W=G,G=void 0);var Q={meta:p,data:s,last:u},j=this._mixin(!1,G,{ext:{binary:{}}});this.remoteCall(e,Q,O,j,W)},this.getStatus=function(){return I},this.isDisconnected=ae,this.setBackoffIncrement=function(e){H.backoffIncrement=e},this.getBackoffIncrement=function(){return H.backoffIncrement},this.getBackoffPeriod=function(){return U},this.increaseBackoffPeriod=function(){return Pn()},this.resetBackoffPeriod=function(){ye()},this.setLogLevel=function(e){H.logLevel=e},this.registerExtension=function(e,s){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!be(e))throw"Illegal argument type: extension name must be a string";for(var u=!1,p=0;p<_.length;++p){var O=_[p];if(O.name===e){u=!0;break}}return u?(this._info("Could not register extension with name",e,"since another extension with the same name already exists"),!1):(_.push({name:e,extension:s}),this._debug("Registered extension",e),V(s.registered)&&s.registered(e,this),!0)},this.unregisterExtension=function(e){if(!be(e))throw"Illegal argument type: extension name must be a string";for(var s=!1,u=0;u<_.length;++u){var p=_[u];if(p.name===e){_.splice(u,1),s=!0,this._debug("Unregistered extension",e);var O=p.extension;V(O.unregistered)&&O.unregistered();break}}return s},this.getExtension=function(e){for(var s=0;s<_.length;++s){var u=_[s];if(u.name===e)return u.extension}return null},this.getName=function(){return f},this.getClientId=function(){return w},this.getURL=function(){if(g){var e=g.getURL();if(e||(e=H.urls[g.getType()],e))return e}return H.url},this.getTransport=function(){return g},this.getConfiguration=function(){return this._mixin(!0,{},H)},this.getAdvice=function(){return this._mixin(!0,{},R)},this.setTimeout=function(e,s){return T.setTimeout(function(){try{n._debug("Invoking timed function",e),e()}catch(u){n._debug("Exception invoking timed function",e,u)}},s)},this.clearTimeout=function(e){T.clearTimeout(e)},window.WebSocket&&this.registerTransport("websocket",new c),this.registerTransport("long-polling",new S),this.registerTransport("callback-polling",new d)},k=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",".","-",":","+","=","^","!","/","*","?","&","<",">","(",")","[","]","{","}","@","%","$","#"],m=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0],D={encode:function(E){var T=null;if(E instanceof ArrayBuffer?T=E:E.buffer instanceof ArrayBuffer?T=E.buffer:Array.isArray(E)&&(T=new Uint8Array(E).buffer),T==null)throw"Cannot Z85 encode "+E;for(var n=T.byteLength,f=n%4,b=4-(f===0?4:f),a=new DataView(T),g="",I=0,x=0;x<n+b;++x){var w=x>=n;if(I=I*256+(w?0:a.getUint8(x)),(x+1)%4==0){for(var L=85*85*85*85,M=5;M>0;--M){if(!w||M>b){var P=Math.floor(I/L)%85;g+=k[P]}L/=85}I=0}}return g},decode:function(E){for(var T=E.length%5,n=5-(T===0?5:T),f=0;f<n;++f)E+=k[k.length-1];for(var b=E.length,a=new ArrayBuffer(b*4/5-n),g=new DataView(a),I=0,x=0,w=0,L=0;L<b;++L){var M=E.charCodeAt(x++)-32;if(I=I*85+m[M],x%5==0){for(var P=256*256*256;P>=1;)w<g.byteLength&&g.setUint8(w++,Math.floor(I/P)%256),P/=256;I=0}}return a}};return{CometD:l,Transport:y,RequestTransport:o,LongPollingTransport:S,CallbackPollingTransport:d,WebSocketTransport:c,Utils:i,Z85:D}})});var Ct=te(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.default=void 0;var Ir=Or(oe());function Or(t){return t&&t.__esModule?t:{default:t}}var Mr=function(){var r=new Ir.default("amb.GraphQLSubscriptionExtension"),i="/rw/graphql",C="/meta/subscribe",y={};this.isGraphQLChannel=function(o){return o&&o.startsWith(i)},this.addGraphQLChannel=function(o,S){y[o]=S},this.removeGraphQLChannel=function(o){delete y[o]},this.getGraphQLSubscriptions=function(){return y},this.outgoing=function(o){return o.channel===C&&this.isGraphQLChannel(o.subscription)&&(o.ext||(o.ext={}),y[o.subscription]&&(r.debug("Subscribing with GraphQL subscription:"+y[o.subscription]),o.ext.serializedGraphQLSubscription=y[o.subscription])),o}},Nr=Mr;mn.default=Nr});var St=te(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});Cn.default=void 0;var Lr=Rr(oe());function Rr(t){return t&&t.__esModule?t:{default:t}}var Dr=function(){var r=new Lr.default("amb.SessionExtension"),i="/meta/connect",C=!1;this.extendSession=function(){C=!0},this.outgoing=function(y){return y.channel===i&&C&&(y.ext||(y.ext={}),r.debug("extendSession"),y.ext.extendSession=!0,C=!1),y}},kr=Dr;Cn.default=kr});var Tt=te(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.default=void 0;var Ar=Et(oe()),je=Et(Se());function Et(t){return t&&t.__esModule?t:{default:t}}var Gr=function(){var r=new Ar.default("amb.TokenManagementExtension"),i="/meta/subscribe",C="/meta/unsubscribe",y="/meta/handshake",o=je.default.subscribeCommandsFlow.maxInflight,S=[];this.updateTokenCount=function(m){o=m},this.refillTokens=function(){o=je.default.subscribeCommandsFlow.maxInflight,k(),r.debug("refillTokens -- tokenCount : "+o)};function d(m){return m.channel==i||m.channel==C}function c(m){if(!m.ext)return!1;var D=m.ext.received_by_glide;return D?D&&d(D):!1}function l(m){return m.channel===y}this.outgoing=function(m){return l(m)&&(m.ext||(m.ext={}),m.ext.supportsSubscribeCommandFlow=!0),je.default.subscribeCommandsFlow.enable&&d(m)&&o>0&&o--,m},this.incoming=function(m){return je.default.subscribeCommandsFlow.enable&&(d(m)?(o<je.default.subscribeCommandsFlow.maxInflight&&o++,k()):c(m)&&(m=null)),m},this.getTokenCount=function(){return o},this.addTokenAvailabilityListener=function(m){!m||(r.debug("addTokenAvailabilityListener - tokenEventListener : "+m),S.push(m))},this.removeTokenAvailabilityListener=function(m){if(!!m){r.debug("removeTokenAvailabilityListener - tokenEventListener : "+m);var D=S.findIndex(function(E){return m===E});D!==-1&&(r.debug("removeTokenAvailabilityListener - removing listener at index : "+D),S.splice(D,1))}};function k(){r.debug("notifyOnAvailabilityOfToken - current tokenCount: "+o);try{S.forEach(function(m){m()})}catch(m){r.addErrorMessage("notifyOnAvailabilityOfToken - failed to call tokenEventListeners. Error Details : "+m)}}},Br=Gr;Sn.default=Br});var rt=te(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.default=void 0;var nt=Be(mt()),Fr=Be(tt()),Ur=Be(oe()),qr=Be(bn()),Hr=Be(Ct()),yt=Se(),Pr=Be(St()),Wr=Be(Tt());function Be(t){return t&&t.__esModule?t:{default:t}}var zr=function(){var r=new nt.default.CometD;r.registerTransport(yt.WEBSOCKET_TYPE_NAME,new nt.default.WebSocketTransport,0),r.registerTransport("long-polling",new nt.default.LongPollingTransport,1),r.unregisterTransport("callback-polling");var i=new Hr.default;r.registerExtension("graphQLSubscription",i);var C=new Pr.default;r.registerExtension("sessionExtension",C);var y=new Wr.default;r.registerExtension(yt.TOKEN_MANAGEMENT_EXTENSION,y);var o=new Fr.default(r),S=new Ur.default("amb.MessageClient"),d=!1;return{getServerConnection:function(){return o},isLoggedIn:function(){return o.isLoggedIn()},loginComplete:function(){o.loginComplete()},reestablishSession:function(){o.reestablishSession()},connect:function(){if(d){S.addInfoMessage(">>> connection exists, request satisfied");return}d=!0,o.connect()},reload:function(){d=!1,o.reload()},abort:function(){d=!1,o.abort()},disconnect:function(){d=!1,o.disconnect()},isConnected:function(){return d},getConnectionEvents:function(){return o.getEvents()},subscribeToEvent:function(l,k){return o.subscribeToEvent(l,k)},unsubscribeFromEvent:function(l){o.unsubscribeFromEvent(l)},getConnectionState:function(){return o.getConnectionState()},getClientId:function(){return r.getClientId()},getChannel:function(l,k){var m=k||{},D=m.subscriptionCallback,E=m.serializedGraphQLSubscription,T=m.subscribeOptionsCallback,n=o.getChannel(l,T);return i.isGraphQLChannel(l)&&(E?i.addGraphQLChannel(l,E):S.addErrorMessage("Serialized subscription not present for GraphQL channel "+l)),new qr.default(n,o,D)},removeChannel:function(l){o.removeChannel(l),i.isGraphQLChannel(l)&&i.removeGraphQLChannel(l)},getChannels:function(){return o.getChannels()},extendSession:function(){C.extendSession()},getTokenManagementExtension:function(){return y},registerExtension:function(l,k){r.registerExtension(l,k)},unregisterExtension:function(l){r.unregisterExtension(l)},batch:function(l){r.batch(l)}}},Qr=zr;En.default=Qr});var it=te((Tn,xt)=>{(function(t,r){typeof Tn=="object"?xt.exports=Tn=r():typeof define=="function"&&define.amd?define([],r):t.CryptoJS=r()})(Tn,function(){var t=t||function(r,i){var C=Object.create||function(){function n(){}return function(f){var b;return n.prototype=f,b=new n,n.prototype=null,b}}(),y={},o=y.lib={},S=o.Base=function(){return{extend:function(n){var f=C(this);return n&&f.mixIn(n),(!f.hasOwnProperty("init")||this.init===f.init)&&(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var f in n)n.hasOwnProperty(f)&&(this[f]=n[f]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=o.WordArray=S.extend({init:function(n,f){n=this.words=n||[],f!=i?this.sigBytes=f:this.sigBytes=n.length*4},toString:function(n){return(n||l).stringify(this)},concat:function(n){var f=this.words,b=n.words,a=this.sigBytes,g=n.sigBytes;if(this.clamp(),a%4)for(var I=0;I<g;I++){var x=b[I>>>2]>>>24-I%4*8&255;f[a+I>>>2]|=x<<24-(a+I)%4*8}else for(var I=0;I<g;I+=4)f[a+I>>>2]=b[I>>>2];return this.sigBytes+=g,this},clamp:function(){var n=this.words,f=this.sigBytes;n[f>>>2]&=4294967295<<32-f%4*8,n.length=r.ceil(f/4)},clone:function(){var n=S.clone.call(this);return n.words=this.words.slice(0),n},random:function(n){for(var f=[],b=function(x){var x=x,w=987654321,L=4294967295;return function(){w=36969*(w&65535)+(w>>16)&L,x=18e3*(x&65535)+(x>>16)&L;var M=(w<<16)+x&L;return M/=4294967296,M+=.5,M*(r.random()>.5?1:-1)}},a=0,g;a<n;a+=4){var I=b((g||r.random())*4294967296);g=I()*987654071,f.push(I()*4294967296|0)}return new d.init(f,n)}}),c=y.enc={},l=c.Hex={stringify:function(n){for(var f=n.words,b=n.sigBytes,a=[],g=0;g<b;g++){var I=f[g>>>2]>>>24-g%4*8&255;a.push((I>>>4).toString(16)),a.push((I&15).toString(16))}return a.join("")},parse:function(n){for(var f=n.length,b=[],a=0;a<f;a+=2)b[a>>>3]|=parseInt(n.substr(a,2),16)<<24-a%8*4;return new d.init(b,f/2)}},k=c.Latin1={stringify:function(n){for(var f=n.words,b=n.sigBytes,a=[],g=0;g<b;g++){var I=f[g>>>2]>>>24-g%4*8&255;a.push(String.fromCharCode(I))}return a.join("")},parse:function(n){for(var f=n.length,b=[],a=0;a<f;a++)b[a>>>2]|=(n.charCodeAt(a)&255)<<24-a%4*8;return new d.init(b,f)}},m=c.Utf8={stringify:function(n){try{return decodeURIComponent(escape(k.stringify(n)))}catch(f){throw new Error("Malformed UTF-8 data")}},parse:function(n){return k.parse(unescape(encodeURIComponent(n)))}},D=o.BufferedBlockAlgorithm=S.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(n){typeof n=="string"&&(n=m.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes},_process:function(n){var f=this._data,b=f.words,a=f.sigBytes,g=this.blockSize,I=g*4,x=a/I;n?x=r.ceil(x):x=r.max((x|0)-this._minBufferSize,0);var w=x*g,L=r.min(w*4,a);if(w){for(var M=0;M<w;M+=g)this._doProcessBlock(b,M);var P=b.splice(0,w);f.sigBytes-=L}return new d.init(P,L)},clone:function(){var n=S.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0}),E=o.Hasher=D.extend({cfg:S.extend(),init:function(n){this.cfg=this.cfg.extend(n),this.reset()},reset:function(){D.reset.call(this),this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){n&&this._append(n);var f=this._doFinalize();return f},blockSize:512/32,_createHelper:function(n){return function(f,b){return new n.init(b).finalize(f)}},_createHmacHelper:function(n){return function(f,b){return new T.HMAC.init(n,b).finalize(f)}}}),T=y.algo={};return y}(Math);return t})});var Ot=te((yn,wt)=>{(function(t,r){typeof yn=="object"?wt.exports=yn=r(it()):typeof define=="function"&&define.amd?define(["./core"],r):r(t.CryptoJS)})(yn,function(t){return function(){var r=t,i=r.lib,C=i.WordArray,y=r.enc,o=y.Base64={stringify:function(d){var c=d.words,l=d.sigBytes,k=this._map;d.clamp();for(var m=[],D=0;D<l;D+=3)for(var E=c[D>>>2]>>>24-D%4*8&255,T=c[D+1>>>2]>>>24-(D+1)%4*8&255,n=c[D+2>>>2]>>>24-(D+2)%4*8&255,f=E<<16|T<<8|n,b=0;b<4&&D+b*.75<l;b++)m.push(k.charAt(f>>>6*(3-b)&63));var a=k.charAt(64);if(a)for(;m.length%4;)m.push(a);return m.join("")},parse:function(d){var c=d.length,l=this._map,k=this._reverseMap;if(!k){k=this._reverseMap=[];for(var m=0;m<l.length;m++)k[l.charCodeAt(m)]=m}var D=l.charAt(64);if(D){var E=d.indexOf(D);E!==-1&&(c=E)}return S(d,c,k)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function S(d,c,l){for(var k=[],m=0,D=0;D<c;D++)if(D%4){var E=l[d.charCodeAt(D-1)]<<D%4*2,T=l[d.charCodeAt(D)]>>>6-D%4*2;k[m>>>2]|=(E|T)<<24-m%4*8,m++}return C.create(k,m)}}(),t.enc.Base64})});var Mt=te((xn,It)=>{(function(t,r){typeof xn=="object"?It.exports=xn=r(it()):typeof define=="function"&&define.amd?define(["./core"],r):r(t.CryptoJS)})(xn,function(t){return t.enc.Utf8})});var st=te(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.default=void 0;var Vr=at(rt()),Yr=at(Ot()),Kr=at(Mt());function at(t){return t&&t.__esModule?t:{default:t}}var $r=function(){var r=Xr(window);if(!r){var i=Nt(window)&&window.frameElement!==null;r=Rt(Zr(i),window),Jr(r)}return Rt(r,window)};function Xr(t){try{if(!Nt(t))for(;t!==t.parent&&!t.g_ambClient;)t=t.parent;if(t.g_ambClient)return t.g_ambClient}catch(r){console.log("AMB getClient() tried to access parent from an iFrame. Caught error: "+r)}return null}function Nt(t){return t.MSInputMethodContext&&t.document.documentMode}function Rt(t,r){if(typeof t.getClientWindow!="undefined"){var i=t.getClientWindow();if(i===r)return t}var C=jr({},t);return C.getChannel=function(y,o,S){return t.getChannel(y,o,S||r)},C.getRecordWatcherChannel=function(y,o,S,d,c){return t.getRecordWatcherChannel(y,o,S,d,c||r)},C.subscribeToEvent=function(y,o,S){return t.subscribeToEvent(y,o,S||r)},C.unsubscribeFromEvent=function(y,o){return t.unsubscribeFromEvent(y,o||r)},C.getClientWindow=function(){return r},C}function jr(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}function Jr(t){var r=window.self;r.g_ambClient=t,r.addEventListener("unload",function(){r.g_ambClient.disconnect()});var i=1e4,C=r.NOW&&r.NOW.hasOwnProperty("deferAmbConnection")?r.NOW.deferAmbConnection:!1,y=r.NOW&&r.NOW.hasOwnProperty("deferredAmbConnectionTimeout")&&l(r.NOW.deferredAmbConnectionTimeout)?r.NOW.deferredAmbConnectionTimeout:i;if(C)r.setTimeout(d,y);else{var o=r.document?r.document.readyState:null;o==="complete"?d():r.addEventListener("load",d),r.setTimeout(d,i)}var S=!1;function d(){S||(S=!0,r.g_ambClient.connect())}function c(k){return parseInt(k,10)===k}function l(k){return c(k)&&k>0}}function Zr(t){return function(){var i=new Vr.default,C=r(),y=i.getServerConnection();return t&&y.setLoginWindowEnabled(!1),{getServerConnection:function(){return y},connect:function(){i.connect()},abort:function(){i.abort()},disconnect:function(){i.disconnect()},getConnectionState:function(){return i.getConnectionState()},getState:function(){return i.getConnectionState()},getClientId:function(){return i.getClientId()},getChannel:function(S,d,c){var l=i.getChannel(S,d),k=l.subscribe,m=l.unsubscribe;return c=c||window,l.subscribe=function(D){return C.add(c,l,D,function(){l.unsubscribe(D)}),k.call(l,D),l},l.unsubscribe=function(D){C.remove(c,l,D);var E=m.call(l,D);return y.getChannel(S).getChannelListeners().length===0&&i.removeChannel(S),E},l},getChannel0:function(S,d){return i.getChannel(S,d)},getRecordWatcherChannel:function(S,d,c,l,k){var m=Yr.default.stringify(Kr.default.parse(d)).replace(/=/g,"-");return c=c||"default",this.getChannel("/rw/"+c+"/"+S+"/"+m,l,k)},registerExtension:function(S,d){i.registerExtension(S,d)},unregisterExtension:function(S){i.unregisterExtension(S)},batch:function(S){i.batch(S)},subscribeToEvent:function(S,d,c){c=c||window;var l=i.subscribeToEvent(S,d);return C.add(c,l,!0,function(){i.unsubscribeFromEvent(l)}),l},unsubscribeFromEvent:function(S,d){d=d||window,C.remove(d,S,!0),i.unsubscribeFromEvent(S)},isLoggedIn:function(){return i.isLoggedIn()},getConnectionEvents:function(){return i.getConnectionEvents()},getEvents:function(){return i.getConnectionEvents()},reestablishSession:function(){i.reestablishSession()},loginComplete:function(){i.loginComplete()},getChannels:function(){return i.getChannels()},extendSession:function(){return i.extendSession()},getTokenManagementExtension:function(){return i.getTokenManagementExtension()}}}();function r(){var i=[];function C(c,l,k,m){if(!(!c||!k||!m)){y(c,l,k);var D=o(c);D||(D=S(c)),!D.unloading&&D.subscriptions.push({id:l,callback:k,unsubscribe:m})}}function y(c,l,k){if(!(!c||!k)){var m=o(c);if(!!m)for(var D=m.subscriptions,E=D.length-1;E>=0;E--)D[E].id===l&&D[E].callback===k&&D.splice(E,1)}}function o(c){for(var l=0,k=i.length;l<k;l++)if(i[l].window===c)return i[l];return null}function S(c){var l={window:c,onUnload:function(){l.unloading=!0;for(var m=l.subscriptions,D;D=m.pop();)D.unsubscribe();d(l)},unloading:!1,subscriptions:[]};return c.addEventListener("unload",l.onUnload),i.push(l),l}function d(c){for(var l=0,k=i.length;l<k;l++)if(i[l].window===c.window){i.splice(l,1);break}c.subscriptions=[],c.window.removeEventListener("unload",c.onUnload),c.onUnload=null,c.window=null}return{add:C,remove:y}}}var ei=$r;wn.default=ei});var On=te(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.WS_CONNECTION_NODE_ID=ie.NODEID_COOKIE_KEY=ie.MSG_SHARD=ie.MSG_NUM=ie.META_HANDSHAKE=ie.MESSAGE_REDELIVERY_OPTIONS=ie.GLIDE_REMEMBER_ME=ie.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC=ie.CHANNEL_READY_TO_DELIVER=ie.CHANNEL_NOT_READY_TO_DELIVER=void 0;var ni="msg_num";ie.MSG_NUM=ni;var ti="msg_shard";ie.MSG_SHARD=ti;var ri="msg_redelivery_options";ie.MESSAGE_REDELIVERY_OPTIONS=ri;var ii="Channel set to deliver messages now: ";ie.CHANNEL_READY_TO_DELIVER=ii;var ai="Channel set to not deliver messages until re-subscription & re-delivery of missed messages is over: ";ie.CHANNEL_NOT_READY_TO_DELIVER=ai;var si="/meta/handshake";ie.META_HANDSHAKE=si;var oi="glide.amb.wsConnectionNodeId";ie.WS_CONNECTION_NODE_ID=oi;var ui="glide_node_id_for_js";ie.NODEID_COOKIE_KEY=ui;var ci="glide.remember.me";ie.GLIDE_REMEMBER_ME=ci;var li="glide.amb.hup.signal.reconnect.in.sec";ie.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC=li});var Dt=te(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.default=void 0;var di=fi(oe()),pe=On();function fi(t){return t&&t.__esModule?t:{default:t}}function hi(t,r){var i=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=gi(t))||r&&t&&typeof t.length=="number"){i&&(t=i);var C=0,y=function(){};return{s:y,n:function(){return C>=t.length?{done:!0}:{done:!1,value:t[C++]}},e:function(l){throw l},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,S=!1,d;return{s:function(){i=i.call(t)},n:function(){var l=i.next();return o=l.done,l},e:function(l){S=!0,d=l},f:function(){try{!o&&i.return!=null&&i.return()}finally{if(S)throw d}}}}function gi(t,r){if(!!t){if(typeof t=="string")return Lt(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Lt(t,r)}}function Lt(t,r){(r==null||r>t.length)&&(r=t.length);for(var i=0,C=new Array(r);i<r;i++)C[i]=t[i];return C}var vi=function(){var r=new di.default("amb.MessagesRedeliveryManager"),i="redelivery_message",C="redelivery_notification",y="is_last_redelivery",o="can_redeliver",S="redelivery_not_authorized",d=[],c=[],l,k,m=function(M){return E(M)&&M.ext[i][y]===!0},D=function(M){return M.ext[C]&&M.ext[C][o]===!1},E=function(M){return M.ext[i]},T=function(M){return M.ext[i][S]!==!0},n=function(M,P){return M.ext[pe.MSG_SHARD]===P.ext[pe.MSG_SHARD]&&M.ext[pe.MSG_NUM]===P.ext[pe.MSG_NUM]},f=function(M,P){return M.find(function(A){return n(A,P)})},b=function(M,P){return P.filter(function(A){return!f(M,A)})},a=function(){return d.length>0||c.length>0},g=function(M){return pe.MSG_NUM+":"+M.ext[pe.MSG_NUM]+","+pe.MSG_SHARD+":"+M.ext[pe.MSG_SHARD]};function I(L){var M="",P=hi(L),A;try{for(P.s();!(A=P.n()).done;){var h=A.value;M=M.concat("<"+g(h)+">")}}catch(N){P.e(N)}finally{P.f()}return M}function x(){r.debug("Clearing all messages"),d=[],c=[]}function w(){r.debug("Redelivery over"),l=!1,k=!0}return{resetState:function(){x(),l=!0,k=!1},containsMetaInfo:function(M){return M.ext&&M.ext[pe.MSG_NUM]&&M.ext[pe.MSG_SHARD]},shouldDeliver:function(M){return l?D(M)?(r.debug("No messages to redeliver"),l=!1,!1):(this.containsMetaInfo(M)&&(E(M)&&T(M)?(r.debug("Processing redelivered - "+g(M)),d.push(M)):E(M)&&!T(M)?r.debug("Not Processing unauthorized redelivery message - "+g(M)):(c.push(M),r.debug("Processing original - "+g(M))),m(M)&&w()),!1):f(d,M)?(r.debug("Dropping duplicate: "+g(M)),!1):(r.debug("Out of redelivery. New message received: "+g(M)),x(),!0)},shouldDeliverPendingMessages:function(){return k},getAllPendingMessages:function(){var M=[];if(a()){var P=b(d,c);M=d.concat(P)}return r.debug("Flushing: "+I(M)),d=M,c=[],k=!1,M},getMissedMessagesSize:function(){return d.length},getOriginalMessagesSize:function(){return c.length}}},bi=vi;In.default=bi});var ot=te(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.default=void 0;var _i=Nn(oe()),Rn=pn(),kt=Nn(st()),pi=Nn(Dt()),mi=Nn(Se()),Ie=On();function Nn(t){return t&&t.__esModule?t:{default:t}}var Ci=function(r,i,C){var y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:function(){return{}},o=null,S=null,d=[],c=[],l=new _i.default("amb.Channel"),k=0,m=C,D=-1,E=null,T="last_msg_num",n="last_msg_shard",f="request_duration",b=!0,a=new pi.default;function g(){var x=r.getStatus();return x==="disconnecting"||x==="disconnected"}function I(){return(0,kt.default)().getServerConnection().getSubscriptionCommandSender()}return{subscribe:function(w){if(!w.getCallback()){l.addErrorMessage("Cannot subscribe to channel: "+i+", callback not provided");return}for(var L=0;L<d.length;L++)if(d[L]===w)return l.debug("Channel listener already in the list"),w.getID();d.push(w);var M=w.getSubscriptionCallback();if(M&&(S?M(S):c.push(M)),!o&&m)try{this.subscribeToCometD()}catch(P){l.addErrorMessage(P);return}return++k},resubscribe:function(){o=null;for(var w=0;w<d.length;w++)d[w].resubscribe()},_handleResponse:function(w){b?this.processMessageCallback(w):this.processReSubscriptionMessages(w)},processReSubscriptionMessages:function(w){var L=this,M=a.shouldDeliver(w);M?(l.debug(Ie.CHANNEL_READY_TO_DELIVER+i),b=!0,this.processMessageCallback(w)):a.shouldDeliverPendingMessages()&&a.getAllPendingMessages().forEach(function(P){return L.processMessageCallback(P)})},processMessageCallback:function(w){for(var L=0;L<d.length;L++)d[L].getCallback()(w);a.containsMetaInfo(w)&&(D=w.ext[Ie.MSG_NUM],E=w.ext[Ie.MSG_SHARD])},unsubscribe:function(w){if(!w){l.addErrorMessage("Cannot unsubscribe from channel: "+i+", listener argument does not exist");return}for(var L=0;L<d.length;L++)if(d[L].getID()===w.getID()){d.splice(L,1);break}d.length<1&&o&&!g()&&this.unsubscribeFromCometD()},publish:function(w,L){r.publish(i,w,L)},subscribeToCometD:function(){l.debug("subscribeToCometD channelName : "+i+", subscription : "+o),I()?I().subscribeToChannel(this):this._subscribeToCometD(this.subscriptionCallback)},_subscribeToCometD:function(w){l.debug("_subscribeToCometD channelName : "+i);var L=this._populateSubscriptionOptions();if((0,Rn.isNil)(L)||(0,Rn.isEmptyObject)(L))o=r.subscribe(i,this._handleResponse.bind(this),w);else{var M={subscribeOptions:L};o=r.subscribe(i,this._handleResponse.bind(this),M,w)}l.debug("Successfully subscribed to channel: "+i+", subscribeOptions: "+JSON.stringify(L))},_populateSubscriptionOptions:function(){var w=y(),L=Date.now()-this.fetchDisconnectionTS();return this._shouldRedeliveryBeRequested(L)&&((0,Rn.isNil)(w)&&(w={}),w[Ie.MESSAGE_REDELIVERY_OPTIONS]={},w[Ie.MESSAGE_REDELIVERY_OPTIONS][T]=D,w[Ie.MESSAGE_REDELIVERY_OPTIONS][n]=E,w[Ie.MESSAGE_REDELIVERY_OPTIONS][f]=L,l.debug(Ie.CHANNEL_NOT_READY_TO_DELIVER+i),b=!1,a.resetState()),w},_shouldRedeliveryBeRequested:function(w){return w<=mi.default.redeliveryDisconnectTimeoutInMins*6e4&&D!=-1&&!(0,Rn.isNil)(E)},subscriptionCallback:function(w){l.debug("Cometd subscription callback completed for channel: "+i),l.debug("Listener callback queue size: "+c.length),S=w,c.map(function(L){L(S)}),c=[]},unsubscribeFromCometD:function(){l.debug("unsubscribeFromCometD  from : "+i+", subscription : "+o),o!==null&&(I()?I().unsubscribeToChannel(this):this._unsubscribeFromCometD())},_unsubscribeFromCometD:function(){l.debug("_unsubscribeFromCometD  from : "+i+", subscription : "+o),o!==null&&(r.unsubscribe(o),o=null,S=null,l.debug("Successfully unsubscribed from channel: "+i))},resubscribeToCometD:function(){l.debug("Resubscribe to "+i),I()?I().subscribeToChannel(this):this._subscribeToCometD(this.subscriptionCallback)},getSubscribeOptionsCallback:function(){return y},getName:function(){return i},getChannelListeners:function(){return d},getLastMessageShard:function(){return E},getLastMessageNumber:function(){return D},fetchDisconnectionTS:function(){var w=(0,kt.default)().getServerConnection().getConnectionBrokenTS();return l.debug("Client Disconnect Time in ms:"+w),w||0},getRedeliveryManager:function(){return a},isReadyToDeliver:function(){return b},getListenerCallbackQueue:function(){return c},setSubscriptionCallbackResponse:function(w){S=w}}},Si=Ci;Mn.default=Si});var Bt=te(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.default=void 0;var Ti=Ei(oe());function Ei(t){return t&&t.__esModule?t:{default:t}}function At(t,r){for(var i=0;i<r.length;i++){var C=r[i];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(t,C.key,C)}}function yi(t,r,i){return r&&At(t.prototype,r),i&&At(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function xi(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Gt(t,r,i){return r in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}var wi=yi(function t(){var r=this;xi(this,t),Gt(this,"emit",function(i,C){window.localStorage.setItem(i,JSON.stringify(C)),window.localStorage.removeItem(i)}),Gt(this,"on",function(i,C){if(r.registeredListeners.has(i)){var y=r.registeredListeners.get(i);window.removeEventListener("storage",y),r.LOGGER.debug("Removed storage event listener "+i)}var o=function(d){var c=d.key,l=d.newValue;c===i&&l&&C(JSON.parse(l))};window.addEventListener("storage",o),r.LOGGER.debug("Registered storage event listener "+i),r.registeredListeners.set(i,o)}),this.registeredListeners=new Map,this.LOGGER=new Ti.default("amb.CrossClientChannel")}),Oi=wi;Ln.default=Oi});var Ft=te(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.default=void 0;var Ii=134217727,Mi=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ii,i=[],C=Math.max(1,Math.floor(r));return{enqueue:function(o){return this.getAvailableSpace()>0?(i.push(o),!0):!1},enqueueMultiple:function(o){return this.getAvailableSpace()>=o.length?(i=i.concat(o),!0):!1},dequeue:function(){var o;return i.length>0&&(o=i.shift()),o},dequeueMultiple:function(o){var S;return o>=0&&i.length>=o&&(S=[],o>0&&(S=i.slice(0,o),i=i.slice(o))),S},clear:function(){i=[]},getSize:function(){return i.length},getCapacity:function(){return C},getAvailableSpace:function(){return C-i.length},getQueueBuffer:function(){return i}}},Ni=Mi;Dn.default=Ni});var qt=te(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});kn.default=void 0;var me=Ut(Se()),Me=pn(),Ri=Ut(oe());function Ut(t){return t&&t.__esModule?t:{default:t}}var Li=function(r,i){var C={SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe"},y=202,o=429,S=5*60*1e3,d=new Ri.default("amb.SubscriptionCommandSender");E();var c=!me.default.subscribeCommandsFlow.enable,l=null;function k(h,N,U){return Math.min(U,Math.max(N,h))}function m(){return k(i.getTokenCount(),0,me.default.subscribeCommandsFlow.maxInflight)}function D(){return i.getTokenCount()>=me.default.subscribeCommandsFlow.maxInflight}function E(){i.addTokenAvailabilityListener(function(){A()})}function T(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(h||(0,Me.isNil)(l)){var N=k(me.default.subscribeCommandsFlow.maxWait,0,S);d.debug("restartTimer - force: "+h+", timerObject : "+l+", timeInterval : "+N),n(),l=setTimeout(function(){x()},N)}}function n(){(0,Me.isNil)(l)||(d.debug("stopTimer"),clearTimeout(l),l=null)}function f(){d.debug("signalStop - stopping : "+c),c||(c=!0,n(),r.clear())}function b(){var h=parseInt(me.default.subscribeCommandsFlow.retryDelay.min);return h=k(h,0,S),h}function a(h,N,U,K){d.debug("scheduleRetry - channel : "+h.getName()+", triesLeft : "+N+", mode : "+U);var _,R=I(K);switch(U){case C.SUBSCRIBE:{_=function(){return L(h,N,R)};break}case C.UNSUBSCRIBE:{_=function(){return M(h,N,R)};break}}(0,Me.isNil)(_)||setTimeout(_,K)}function g(h,N,U,K,_){d.debug("onResponse - response ".concat(JSON.stringify(h),", channel ").concat(JSON.stringify(N),", mode : ").concat(U,`, 
			triesLeft `).concat(K,", stopping : ").concat(c,", tokenCount : ").concat(i.getTokenCount(),", isBucketFull - ").concat(D(),", retryDelay - ").concat(_)),c?N.subscriptionCallback(h):(K=K-1,D()&&n(),K>0&&P(h)?a(N,K,U,_):N.subscriptionCallback(h),A())}function I(h){return k(me.default.subscribeCommandsFlow.retryDelay.increaseFactor*h,me.default.subscribeCommandsFlow.retryDelay.min,me.default.subscribeCommandsFlow.retryDelay.max)}function x(){l=null,d.debug("onTimer - stopping : "+c),c||(i.refillTokens(),A())}function w(h){return d.debug("addItemToQueue - item : "+h),r.enqueue(h)?(A(),!0):!1}function L(h){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b();if(d.debug("enqueueSubscribe - channel: "+h.getName()+", triesLeft : "+N+", stopping : "+c+", retryDelay : "+U),!c&&(0,Me.isObject)(h)&&((0,Me.isNil)(N)&&(N=1+Math.floor(me.default.subscribeCommandsFlow.retries)),N>0)){var K=function(){d.debug("enqueueSubscribe - inside the item execution. Calling channel._subscribeToCometD - channel: "+h.getName()+", triesLeft : "+N),h._subscribeToCometD(function(R){return g(R,h,C.SUBSCRIBE,N,U)})};return w(K)}return!1}function M(h){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b();if(d.debug("enqueueUnsubscribe - channel: "+h.getName()+", triesLeft : "+N+", stopping : "+c+", retryDelay : "+U),!c&&(0,Me.isObject)(h)&&((0,Me.isNil)(N)&&(N=1+Math.floor(me.default.subscribeCommandsFlow.retries)),N>0)){var K=function(){h._unsubscribeFromCometD(function(R){return g(R,h,C.UNSUBSCRIBE,N,U)})};return w(K)}return!1}function P(h){if(d.debug("isRetriable - response : "+h),h&&h.ext){var N=h.ext.rejected_by_glide;if(N){var U=parseInt(h.ext["glide.amb.reply.status.code"]);if(d.addWarnMessage("isRetriable - rejected_by_glide : "+N+", glide.amb.reply.status.code : "+U),!isNaN(U))return U==o||U==y}}return d.debug("isRetriable -  "+!1),!1}function A(){var h=Math.min(r.getSize(),m());if(d.debug("processQueue - numberToProcess : "+h),h>0){var N=r.dequeueMultiple(h);N.forEach(function(U){return(0,Me.isNil)(U)||U()}),T(!1)}}return{subscribeToChannel:function(N){return d.debug("subscribeToChannel - to : "+N.getName()),L(N)},unsubscribeToChannel:function(N){return d.debug("unsubscribeToChannel - from : "+N.getName()),M(N)},stop:function(){d.debug("stop"),f()},isStopping:function(){return c},getQueue:function(){return r},isBucketEmpty:function(){return!D()},getTimerObject:function(){return l},getTokenCountFromTokenManager:function(){return i.getTokenCount()}}},Di=Li;kn.default=Di});var Wt=te(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.default=void 0;var ki=Ht(oe()),Ai=Ht(Se());function Ht(t){return t&&t.__esModule?t:{default:t}}function Bi(t,r){var i=typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=Gi(t))||r&&t&&typeof t.length=="number"){i&&(t=i);var C=0,y=function(){};return{s:y,n:function(){return C>=t.length?{done:!0}:{done:!1,value:t[C++]}},e:function(l){throw l},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,S=!1,d;return{s:function(){i=i.call(t)},n:function(){var l=i.next();return o=l.done,l},e:function(l){S=!0,d=l},f:function(){try{!o&&i.return!=null&&i.return()}finally{if(S)throw d}}}}function Gi(t,r){if(!!t){if(typeof t=="string")return Pt(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Pt(t,r)}}function Pt(t,r){(r==null||r>t.length)&&(r=t.length);for(var i=0,C=new Array(r);i<r;i++)C[i]=t[i];return C}var Fi=function(r){var i={},C=new ki.default("amb.TransportManagement");return i.isPruningEnabled=function(){return Ai.default.pruneFailedTransports!=="false"},i.processConnectionOpened=function(){this.isPruningEnabled()&&(C.debug("Processing connection opened"),this.removeSkippedTransportsInConnect())},i.removeSkippedTransportsInConnect=function(){var y=r.getTransport()===null?null:r.getTransport().getType();if(C.addInfoMessage("Connected using transport "+y),C.debug("Purging failed transports from registry..."),y!==null){var o=[],S=Bi(r.getTransportTypes()),d;try{for(S.s();!(d=S.n()).done;){var c=d.value;if(c==y)break;r.unregisterTransport(c),o.push(c)}}catch(l){S.e(l)}finally{S.f()}C.addInfoMessage("Removed failed registry transports after connect: {"+o+"}")}},i},Ui=Fi;An.default=Ui});var tt=te(Gn=>{"use strict";function ut(t){return ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ut(t)}Object.defineProperty(Gn,"__esModule",{value:!0});Gn.default=void 0;var qi=Ne(Zn()),Hi=Ne(oe()),$=Pi(Se()),Wi=Ne($n()),zi=Ne(ot()),Qi=Ne(Bt()),zt=pn(),Vi=Ne(Ft()),Yi=Ne(qt()),Ki=Ne(Wt()),Ee=On();function Qt(t){if(typeof WeakMap!="function")return null;var r=new WeakMap,i=new WeakMap;return(Qt=function(y){return y?i:r})(t)}function Pi(t,r){if(!r&&t&&t.__esModule)return t;if(t===null||ut(t)!=="object"&&typeof t!="function")return{default:t};var i=Qt(r);if(i&&i.has(t))return i.get(t);var C={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var S=y?Object.getOwnPropertyDescriptor(t,o):null;S&&(S.get||S.set)?Object.defineProperty(C,o,S):C[o]=t[o]}return C.default=t,i&&i.set(t,C),C}function Ne(t){return t&&t.__esModule?t:{default:t}}var Xi=function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Qi.default,C=!1,y=!1,o=null,S=new qi.default({CONNECTION_INITIALIZED:"connection.initialized",CONNECTION_OPENED:"connection.opened",CONNECTION_CLOSED:"connection.closed",CONNECTION_BROKEN:"connection.broken",SESSION_LOGGED_IN:"session.logged.in",SESSION_LOGGED_OUT:"session.logged.out",SESSION_INVALIDATED:"session.invalidated",SESSION_REESTABLISHED:"session.reestablished"}),d={SESSION_LOGGED_IN:"session.logged.in",SESSION_LOGGED_OUT:"session.logged.out",SESSION_INVALIDATED:"session.invalidated"},c="closed",l={},k={},m=new Hi.default("amb.ServerConnection");ue();var D=d.SESSION_INVALIDATED,E=null,T=$.default.loginWindow==="true",n=null,f={UNKNOWN_CLIENT:"402::Unknown client",UNKNOWN_SESSION:"402::session_unknown",NODE_MISMATCH:"websocket_http_node_mismatch",RECONNECT_REMEMBER_ME:"reconnect_remember_me_http_activity",HUP_SIGNAL:"reconnect_on_hup_signal"},b=!1,a={},g=!1,I=new Wi.default(r,a),x=!1,w="glide.amb.session.logout.overlay.style",L="glide.amb.redelivery.disconnect.timeout.in.mins",M="glide.amb.clear_node_affinity_cookie",P="glide.session.status",A="session.touch.http",h="amb.ServerConnection.reestablish.session",N="set.header.request.sent",U="request.reconnection",K=r.getExtension($.TOKEN_MANAGEMENT_EXTENSION),_=null,R=new Ki.default(r),q=null,F=!0,z=null,Z=null,X=null,ne=null,J=null;a.connect=function(){if(C){m.debug(">>> connection exists, request satisfied");return}m.debug("Connecting to glide amb server -> "+$.default.servletURI),r.configure({url:a.getURL($.default.servletPath),logLevel:$.default.logLevel,connectTimeout:$.default.wsConnectTimeout}),r.handshake(),i.on(h,function(){a._reestablishSession(!1)}),i.on(N,function(){F=!1}),i.on(U,function(){m.debug("Received signal to reconnect"),Kn()})},a.reload=function(){r.reload()},a.abort=function(){r.getTransport().abort()},a.disconnect=function(v){m.debug("Disconnecting from glide amb server.."),y=!0,r.disconnect(v)},a.getURL=function(v){return window.location.protocol+"//"+window.location.host+"/"+v},a.getConnectionBrokenTS=function(){return q};function ue(){r.addListener("/meta/handshake",this,se),r.addListener("/meta/connect",this,le),r.addListener("/meta/subscribe",this,Ue),r.addListener("/meta/unsubscribe",this,Fe)}function se(v){Fe(v),H(v,Ee.WS_CONNECTION_NODE_ID)!==void 0&&(o=H(v,Ee.WS_CONNECTION_NODE_ID),m.debug("Node Id from handshake callback initially set to "+o));var B=H(v,w);B&&($.default.overlayStyle=B);var Y=H(v,L);Y&&($.default.redeliveryDisconnectTimeoutInMins=Y);var ee=H(v,M);ee&&($.default.requestHeaderToClearStickySessionCookie=H(v,M)===!0),D=H(v,P),en(v),setTimeout(function(){v.successful&&an()},0)}function H(v,B){if((0,zt.isObject)(v.ext))return v.ext[B]}function We(v,B){if(v in l)return l[v];var Y=new zi.default(r,v,x,B);return l[v]=Y,Y}function be(v){k[v]=l[v],delete l[v]}function Fe(v){if(v.ext){v.ext["glide.amb.active"]===!1&&a.disconnect();var B=H(v,"glide.amb.client.log.level");B&&($.default.logLevel=B,r.setLogLevel($.default.logLevel)),$.default.pruneFailedTransports=H(v,"glide.amb.pruneFailedTransports")!=="false"}}function Un(){var v=ze();v!==null&&(clearInterval(Z),Z=null,z=null,g=!0,n=f.RECONNECT_REMEMBER_ME,a.connect())}function ze(){if(typeof document.cookie!="undefined")for(var v=document.cookie.split(";"),B=0;B<v.length;B++){var Y=v[B].trim();if(Y.startsWith("".concat(Ee.NODEID_COOKIE_KEY,"=")))return Y.substring(Ee.NODEID_COOKIE_KEY.length+1)}return null}function Qe(){if(o!==null){var v=ze();v!==null&&o!==v&&setTimeout(function(){v=ze(),v!==null&&o!==v&&(m.addInfoMessage("WS Connection is with "+o+" whereas httpsession is with "+v+". Disconnecting WS connection"),Re(f.NODE_MISMATCH))},2e4)}}function V(v){X||(X=setTimeout(function(){m.addInfoMessage("Reconnecting after "+v+"sec as the server received an HUP signal from load balancer"),Re(f.HUP_SIGNAL)},v*1e3))}function Re(v){o=null,y=!0,r.disconnect(function(){m.addInfoMessage("Disconnected WS Connection. Connecting back"),n=v,C=!1,ye(),X=null,g=!0,y=!1,a.connect()})}function Ue(v){Fe(v)}function _e(v,B){var Y=Math.floor(parseInt(v));return(isNaN(Y)||Y<0)&&(Y=B),Y}function qn(v,B){var Y=B;return(0,zt.isNil)(v)||(Y=!!v),Y}function en(v){if(!!v.ext){var B=v.ext.subscribeCommandsFlow;if(!!B){var Y=$.default.subscribeCommandsFlow;if($.default.subscribeCommandsFlow.enable=qn(B.enable,Y.enable),$.default.subscribeCommandsFlow.enable){$.default.subscribeCommandsFlow.retries=_e(B.retries,Y.retries),$.default.subscribeCommandsFlow.maxInflight=_e(B.maxInflight,Y.maxInflight),$.default.subscribeCommandsFlow.maxWait=_e(B.maxWait,Y.maxWait);var ee=B.retryDelay;if(ee){var Ae=$.default.subscribeCommandsFlow.retryDelay;$.default.subscribeCommandsFlow.retryDelay.min=_e(ee.min,Ae.min),$.default.subscribeCommandsFlow.retryDelay.max=_e(ee.max,Ae.max),$.default.subscribeCommandsFlow.retryDelay.increaseFactor=_e(ee.increaseFactor,Ae.increaseFactor)}}nn()}}}function nn(){$.default.subscribeCommandsFlow.enable&&(m.addInfoMessage("_initializeSubscriptionCommandSender: SubscriptionCommandSender is enabled"),K!=null&&K.updateTokenCount($.default.subscribeCommandsFlow.maxInflight),_&&_.stop(),_=new Yi.default(new Vi.default(1e4),K))}function tn(){return $.default.requestHeaderToClearStickySessionCookie}function ce(){m.debug("Resubscribing to all!");for(var v in l){var B=l[v];B&&B.resubscribeToCometD()}}function ae(){m.debug("Unsubscribing from all!");for(var v in l){var B=l[v];B&&B.unsubscribeFromCometD()}}function le(v){if(Fe(v),H(v,Ee.GLIDE_REMEMBER_ME)&&(z=H(v,Ee.GLIDE_REMEMBER_ME)),H(v,Ee.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC)&&V(H(v,Ee.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC)),y){setTimeout(function(){C=!1,ye()},0);return}C&&!Xe(H(v,P))&&Qe();var B=H(v,A);rn()&&B===!0&&a._touchHttpSession();var Y=v.error;Y&&(n=Y),Qn(v);var ee=C;C=v.successful===!0,!ee&&C?qe():ee&&!C&&Pn(),ne=new Date}function rn(){return $.WEBSOCKET_TYPE_NAME===r.getTransport().getType()}function Hn(){var v=new XMLHttpRequest;v.open("POST","/amb",!0),v.setRequestHeader("Content-type","application/json"),v.send()}function an(){m.debug("Connection initialized"),x=!0,c="initialized",ge(S.getEvents().CONNECTION_INITIALIZED)}function qe(){m.debug("Connection opened"),R.processConnectionOpened(),g?on():I.initialize(function(){re(!0)})}function re(v){ce(),Ve(),v&&sn()}function sn(){m.debug("Sending signal to reconnect"),i.emit(U,U)}function Ve(){c="opened",ge(S.getEvents().CONNECTION_OPENED)}function on(){if(!Ye(a.getLastError())){m.addWarnMessage("Error connecting to server. Unkown status "+a.getLastError());return}a.setLastError(null),a._sendSessionSetupRequest(function(v){var B=v.status,Y=v.response;if(B!==200){m.addWarnMessage("/amb_session_setup.do status: "+B);return}g=!1;var ee=JSON.parse(Y)["glide.session.status"];m.debug("/amb_session_setup.do response: "+Y),!ee||D===ee?I.initialize(function(){re(!1)}):(I.initialize(Ve),xe(ee))})}function Ye(v){return Object.values(f).includes(v)}function Le(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},B=De();B.onload=function(){return v(B)},B.send()}function De(){m.debug("sending /amb_session_setup.do!");var v=new XMLHttpRequest;return v.open("POST","/amb_session_setup.do",!0),v.setRequestHeader("Content-type","application/json;charset=UTF-8"),v.setRequestHeader("X-UserToken",window.g_ck),v.setRequestHeader("X-CometD-SessionID",r.getClientId()),v}function ye(){m.debug("Connection closed"),c="closed",ge(S.getEvents().CONNECTION_CLOSED)}function Pn(){m.addErrorMessage("Connection broken"),c="broken",g=!0,ge(S.getEvents().CONNECTION_BROKEN),q=Date.now(),Wn()}function Wn(){_&&(_.stop(),_=null)}function un(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},B=zn();B.onload=function(){return v(B)},B.send()}function zn(){var v=new XMLHttpRequest;return v.open("POST","/set_clear_node_affinity_header",!0),v}function Qn(v){var B=H(v,P);!B||B===D||(b=H(v,"glide.amb.login.window.override")===!0,xe(B))}function xe(v){m.debug("session.status - "+v),Xe(v)?ln():ke(v)?He():Ke(v)?fe():cn(v)&&Vn(),D=v}function cn(v){return(D===d.SESSION_INVALIDATED||D===d.SESSION_LOGGED_OUT)&&v===d.SESSION_LOGGED_IN}function ke(v){return D===d.SESSION_LOGGED_IN&&v===d.SESSION_LOGGED_OUT}function Ke(v){return D===d.SESSION_INVALIDATED&&v===d.SESSION_LOGGED_OUT}function Xe(v){return(D===d.SESSION_LOGGED_IN||D===d.SESSION_LOGGED_OUT)&&v===d.SESSION_INVALIDATED}function Vn(){m.debug("LOGGED_IN event fire!"),ce(),ge(S.getEvents().SESSION_LOGGED_IN),a.loginHide(),F=!0}function He(){m.debug("LOGGED_OUT event fire!"),ae(),ge(S.getEvents().SESSION_LOGGED_OUT),T&&!b&&a.loginShow(),Je()}function fe(){m.debug("REESTABLISHED event fire!"),ce(),ge(S.getEvents().SESSION_REESTABLISHED)}function ln(){m.debug("INVALIDATED event fire!"),ae(),ge(S.getEvents().SESSION_INVALIDATED),tn()&&(navigator.locks!==void 0?navigator.locks.request("lock-set_clear_node_affinity_header",fn):(m.debug("navigator.locks.request not supported"),fn())),Je()||a.disconnect(function(){a.loginHide(),C=!1,ye(),y=!1,z&&Ze(Ee.NODEID_COOKIE_KEY)&&(Z=setInterval(Un,5e3))})}function Je(){return ne&&J&&J>ne?(m.debug("Either the session is logged out/invalidated from a different tab. Calling reestablishSession as lastReconnectionEventTime "+J+" happened after lastMetaConnectResponseTime "+ne),$e(!1),!0):!1}function Ze(v){return typeof document.cookie!="undefined"?(document.cookie=v+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/",!0):!1}function fn(){F?(m.debug("Sending set_clear_node_affinity_header"),Yn(),a._sendSetHeaderToClearNodeAffinityCookie(function(v){var B=v.status;B!==200?m.addErrorMessage("Error sending set_clear_node_affinity_header: "+B):F=!1})):m.debug("set_clear_node_affinity_header not sent")}function Yn(){i.emit(N,N)}function ge(v){try{S.publish(v)}catch(B){m.addErrorMessage("error publishing '"+v+"' - "+B)}}function dn(){i.emit(h,h)}a.unsubscribeAll=function(){ae()},a.resubscribeAll=function(){ce()},a.removeChannel=function(v){be(v)},a.getEvents=function(){return S.getEvents()},a.getConnectionState=function(){return c},a.getLastError=function(){return n},a.setLastError=function(v){n=v},a.getErrorMessages=function(){return f},a.isLoggedIn=function(){return D===d.SESSION_LOGGED_IN},a.isSessionActive=function(){return D!==d.SESSION_INVALIDATED},a.getChannelRedirect=function(){return I},a.getChannel=function(v,B){return We(v,B)},a.getChannels=function(){return l},a.getRemovedChannels=function(){return k},a.getState=function(){return c},a.getLoginWindowOverlayStyle=function(){return $.default.overlayStyle},a.loginShow=function(){m.debug("Show login window");var v='<iframe src="/amb_login.do" style="border: 0" height="400px" width="405px"></iframe>',B='<div id="amb_disconnect_modal" tabindex="-1" aria-hidden="true" class="modal" role="dialog" style="'.concat($.default.overlayStyle,`">
				<div class="modal-dialog small-modal" style="width:450px">
				   <div class="modal-content">
					  <header class="modal-header">
						 <h4 id="small_modal1_title" class="modal-title">Login</h4>
					  </header>
					  <div class="modal-body">
					  </div>
				   </div>
				</div>
			</div>`);try{if(window.NOW&&window.NOW.amb_themed_login===!0){var Y=new GlideModal("amb_login_router");Y.renderWithContent&&(Y.template=B),Y.render(),E=Y}else{var ee=new GlideModal("amb_disconnect_modal");ee.renderWithContent?(ee.template=B,ee.renderWithContent(v)):(ee.setBody(v),ee.render()),E=ee}}catch(Ae){m.debug(Ae)}},a.loginHide=function(){!E||(E.destroy(),E=null)},a.loginComplete=function(){a.reestablishSession()};function Kn(){if(!C){a.connect();return}D===d.SESSION_LOGGED_OUT?$e(!1):D===d.SESSION_LOGGED_IN&&(J=new Date)}function $e(v){a._sendSessionSetupRequest(function(B){var Y=B.response;if(!!Y){var ee=JSON.parse(Y)["glide.session.status"];xe(ee)}}),v&&dn()}return a.reestablishSession=function(){a._reestablishSession(!0)},a.subscribeToEvent=function(v,B){return S.getEvents().CONNECTION_OPENED===v&&C&&B(),S.subscribe(v,B)},a.unsubscribeFromEvent=function(v){S.unsubscribe(v)},a.isLoginWindowEnabled=function(){return T},a.setLoginWindowEnabled=function(v){T=v},a.isLoginWindowOverride=function(){return b},a.getSubscriptionCommandSender=function(){return _},a._metaConnect=le,a._metaHandshake=se,a._metaSubscribe=Ue,a._sendSessionSetupRequest=Le,a._onChannelRedirectSubscriptionComplete=re,a._getChannel=We,a._removeChannel=be,a._connectionInitialized=an,a._connectionOpened=qe,a._reestablishSession=$e,a._touchHttpSession=Hn,a._sendSetHeaderToClearNodeAffinityCookie=un,a},Ji=Xi;Gn.default=Ji});var Vt=te(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.default=void 0;var Zi=Te(Se()),$i=Te(oe()),ji=Te(Zn()),ea=Te(tt()),na=Te($n()),ta=Te(bn()),ra=Te(ot()),ia=Te(rt()),aa=Te(st());function Te(t){return t&&t.__esModule?t:{default:t}}var sa={properties:Zi.default,Logger:$i.default,EventManager:ji.default,ServerConnection:ea.default,ChannelRedirect:na.default,ChannelListener:ta.default,Channel:ra.default,MessageClient:ia.default,getClient:aa.default},oa=sa;Bn.default=oa});var Fn=sr(Vt());window.__TECTONIC__amb_client_js=Fn.default;window.amb=Fn.default;var Na=Fn.default;
/*__ESM_BODY_END__*/
export{Na as default};
//# sourceMappingURL=/scripts/externals/amb-client-js/index.min.js.map

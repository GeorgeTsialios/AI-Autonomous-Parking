## Εκπαιδεύσεις με τον αλγόριθμο DDPG {#sec:training:ddpg}

### Επισκόπηση εκπαιδεύσεων {#sec:training:ddpg:overview}

Ο αλγόριθμος DDPG ήταν ο τελευταίος που εξετάστηκε. Συνολικά, διεξήχθησαν 15 εκπαιδεύσεις του αλγορίθμου, οι οποίες διήρκησαν αθροιστικά 7 ημέρες, 3 ώρες και 48 λεπτά. 

Το μικρό, σχετικά, πλήθος των εκπαιδεύσεων οφείλεται στο γεγονός πως οι παράμετροι που χρησιμοποιηθήκαν για τις εκπαιδεύσεις του αλγορίθμου DDPG, προέκυψαν από τις προηγούμενες εκπαιδεύσεις των αλγορίθμων SAC και TD3. Επομένως, δεν απαιτήθηκαν πολλές προσπάθειες, προκειμένου να φτάσει ο αλγόριθμος DDPG σε ικανοποιητικά αποτελέσματα.

Οι μοναδικές τροποποιήσεις που έγιναν, αφορούν την συνάρτηση ανταμοιβής και ειδικότερα, τις ανταμοιβές για την κίνηση του πράκτορα. Συγκεκριμένα, όπως και οι άλλοι αλγόριθμοι της κατηγορίας δράστη-κριτή, οι πράκτορες του DDPG δυσκολεύτηκαν να μάθουν να παρκάρουν και προς τις δύο κατευθύνσεις. Όμως μετά τις κατάλληλες αλλαγές των ανταμοιβών, το πρόβλημα αυτό λύθηκε.

### Καλύτερες εκπαιδεύσεις {#sec:training:ddpg:best-training}

Οι εκπαιδεύσεις ξεκίνησαν κατευθείαν από το επίπεδο δυσκολίας 3, καθώς χρησιμοποιήθηκε η ίδια συνάρτηση ανταμοιβής με τον αλγόριθμο TD3 και οι δύο αλγόριθμοι είναι αρκετά παρόμοιοι. Η καλύτερη εκπαίδευση στο επίπεδο αυτό, φαίνεται στην *Εικόνα @fig:training:ddpg:best-training* με κόκκινο χρώμα (εκπαίδευση 3H). Παρατηρούμε πως μετά από 1.5Μ steps, το success rate προσεγγίζει το 100%.

Στη συνέχεια, εφαρμόστηκε Curriculum Learning στον πράκτορα των 1.3Μ steps της εκπαίδευσης 3H, στο ίδιο επίπεδο, αυξάνοντας την τιμωρία για τις συγκρούσεις.  Η εκπαίδευση αυτή εμφανίζεται στην *Εικόνα @fig:training:ddpg:best-training* με ροζ χρώμα (εκπαίδευση 4). Παρατηρούμε πως μετά από 1Μ steps, το success rate προσεγγίζει το 100%. Η γραφική των ανταμοιβών του πράκτορα συγκλίνει ξανά στην ίδια τιμή με πριν και άρα, καταλαβαίνουμε πως οι συγκρούσεις έχουν μειωθεί. Ωστόσο, στη γραφική εμφανίζονται πολλές απότομες βυθίσεις κι έτσι, γίνεται κατανοητό πως οι συγκρούσεις δεν έχουν εξαλειφθεί πλήρως.

Τέλος, εφαρμόστηκε Curriculum Learning με τον πράκτορα των 1.55Μ steps της εκπαίδευσης 4, στο επίπεδο δυσκολίας 4. Η εκπαίδευση αυτή εμφανίζεται στην *Εικόνα @fig:training:td3:best-training* με πορτοκαλί χρώμα (εκπαίδευση 5Β). Παρατηρούμε πως μετά από μόλις 5Μ steps, το success rate προσεγγίζει το 50%, ενώ η γραφική των ανταμοιβών του πράκτορα ήδη συγκλίνει (η τιμή της δεν μπορεί να συγκριθεί με τις υπόλοιπες, καθώς σε αυτήν την εκπαίδευση αυξήθηκε η ανταμοιβή της στάθμευσης). Εξετάζοντας τον πράκτορα στο παιχνίδι, παρατηρούμε πως η πολιτική του είναι ασταθής. Συγκεκριμένα, σε κάποια επεισόδια παρκάρει άψογα, ενώ σε άλλα κινείται ακανόνιστα, χωρίς να προσπαθεί να παρκάρει. Σε κάθε περίπτωση, οι προσπάθειες μας να ενθαρρύνουμε τον πράκτορα να παρκάρει περισσότερο συχνά, απέβησαν άκαρπες.

![Καλύτερες εκπαιδεύσεις του αλγορίθμου DDPG: με κόκκινο χρώμα στο επίπεδο 3, με ροζ χρώμα στο επίπεδο 3 με αύξηση της τιμωρίας για τις συγκρούσεις και με πορτοκαλί χρώμα στο επίπεδο 4.](5-training/figures/DDPG-best-training.png){width=100% #fig:training:ddpg:best-training}

Επομένως, βλέπουμε οι πράκτορες του αλγορίθμου DDPG κατάφεραν να πετύχουν καλά αποτελέσματα, εκτός του τελικού επιπέδου δυσκολίας, στο οποίο η απόδοση τους δεν είναι συνεπής και άρα, δεν θεωρείται πως έλυσαν αξιόπιστα το πρόβλημα της αυτόματης στάθμευσης.
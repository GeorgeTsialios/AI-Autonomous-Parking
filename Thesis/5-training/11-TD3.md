## Εκπαιδεύσεις με τον αλγόριθμο TD3 {#sec:training:td3}

### Επισκόπηση εκπαιδεύσεων {#sec:training:td3:overview}

Ο αλγόριθμος TD3 ήταν ο δεύτερος της κατηγορίας δράστη-κριτή που εξετάστηκε και αυτός που εν τέλει, πέτυχε τα καλύτερα αποτελέσματα. Συνολικά, διεξήχθησαν 32 εκπαιδεύσεις του αλγορίθμου, οι οποίες διήρκησαν αθροιστικά 21 ημέρες, 23 ώρες και 47 λεπτά.

Αρχικά, δοκιμάσαμε την εκπαίδευση με χρήση της αραιής συνάρτησης ανταμοιβής της υποενότητας @sec:training:modeling:reward. Ωστόσο, ο πράκτορας υιοθέτησε την υποβέλτιστη πολιτική του να στέκεται ακίνητος καθ' όλη τη διάρκεια του επεισοδίου. Έτσι, δοκιμάσαμε τη συνάρτηση με διαμόρφωση ανταμοιβής και μέσω αυτής, επιτεύχθηκαν γρήγορα, ικανοποιητικά αποτελέσματα. Επομένως, μπορέσαμε να αφιερώσουμε χρόνο στη βελτίωση της πολιτικής του πράκτορα, η οποία πάσχιζε από τα εξής δύο προβλήματα:

- Συχνές συγκρούσεις: για παράδειγμα, σε μία εκπαίδευση, ο πράκτορας έμαθε να παρκάρει επιτυχώς και με συνέπεια, όμως κάθε φορά, συγκρουόταν πρώτα με τον κήπο του χάρτη.
- Εξισορρόπηση μεταξύ στάθμευσης προς τα εμπρός και με την όπισθεν: σε κάποιες εκπαιδεύσεις, ο πράκτορας είχε την τάση να παρκάρει πάντα με την όπισθεν, ενώ σε άλλες γινόταν το ανάποδο.

Τα παραπάνω προβλήματα ατιμετωπίστηκαν επιτυχώς, μετά από πολλαπλές τροποποιήσεις των τιμών των ανταμοιβών του πράκτορα.

Ακόμα, όπως και στην περίπτωση του SAC, οφείλουμε να σημειώσουμε την αξία της τεχνικής Frameskip, η οποία αποτέλεσε τον παράγοντα που οδήγησε στην επιτυχία του πράκτορα, στο επίπεδο δυσκολίας 3 (αυτόματη στάθμευση). 

Αντίστοιχα, στο επίπεδο δυσκολίας 4 (κανονική στάθμευση), ο παράγοντας που αποδείχθηκε καθοριστικός ήταν η κλιμακωτή μάθηση, καθώς χωρίς αυτήν, το ποσοστό επιτυχίας του πράκτορα ήταν μηδαμινό.

### Καλύτερες εκπαιδεύσεις {#sec:training:td3:best-training}

Οι εκπαιδεύσεις ξεκίνησαν από το επίπεδο δυσκολίας 2, του οποίου η καλύτερη εκπαίδευση με τον αλγόριθμο TD3 διακρίνεται στην *Εικόνα @fig:training:td3:best-training* με κόκκινο χρώμα (εκπαίδευση 5C). Παρατηρούμε πως μετά από 4Μ steps, η γραφική του success rate προσεγγίζει το 100%.

Στη συνέχεια, χρησιμοποιήθηκαν οι ίδιες παράμετροι εκπαίδευσης για το επίπεδο δυσκολίας 3. Η καλύτερη εκπαίδευση σε αυτό το επίπεδο φαίνεται στην *Εικόνα @fig:training:td3:best-training* με τιρκουάζ χρώμα (εκπαίδευση 10). Παρατηρούμε πως μετά από 2Μ steps, το success rate προσεγγίζει το 100%.

Έπειτα, για να πετύχει ο αλγόριθμος ικανοποιητικές επιδόσεις στο επίπεδο δυσκολίας 4, χρειάστηκε να εφαρμόσουμε Curriculum Learning με τον πράκτορα των 3Μ steps της εκπαίδευσης 10. Η εκπαίδευση αυτή εμφανίζεται στην *Εικόνα @fig:training:td3:best-training* με γκρι χρώμα (εκπαίδευση 15Ε). Παρατηρούμε πως μετά από μόλις 400Κ steps, το success rate προσεγγίζει το 100%. 

Τέλος, εφαρμόσαμε ξανά την τεχνική Curriculum Learning, αυτή τη φορά με τον πράκτορα των 1.5M steps της εκπαίδευσης 15Ε, αυξάνοντας την τιμωρία για τις συγκρούσεις, προκειμένου να μειώσουμε τη συχνότητα αυτών. Η εκπαίδευση αυτή εμφανίζεται στην *Εικόνα @fig:training:td3:best-training* με πορτοκαλί χρώμα (εκπαίδευση 15F). Παρατηρούμε πως μετά από 300K steps, το success rate προσεγγίζει το 100%. Η γραφική των ανταμοιβών του πράκτορα συγκλίνει ξανά στην ίδια τιμή με πριν και άρα, καταλαβαίνουμε πως οι συγκρούσεις έχουν μειωθεί. Ωστόσο, στη γραφική εμφανίζονται πολλές απότομες βυθίσεις, εξαιτίας της μεγάλης πλέον, τιμής της τιμωρίας για τις συγκρούσεις. Επομένως, γίνεται κατανοητό πως οι συγκρούσεις δεν έχουν εξαλειφθεί πλήρως.

![Καλύτερες εκπαιδεύσεις του αλγορίθμου TD3: με κόκκινο χρώμα στο επίπεδο 2, με τιρκουάζ χρώμα στο επίπεδο 3, με γκρι χρώμα στο επίπεδο 4 και με πορτοκαλί χρώμα στο επίπεδο 4 με αύξηση της τιμωρίας για τις συγκρούσεις.](5-training/figures/TD3-best-training.png){width=98% #fig:training:td3:best-training}

Επομένως, βλέπουμε πως οι πράκτορες του αλγορίθμου TD3 έφτασαν σε υψηλά επίπεδα επιδόσεων, σε όλα τα επίπεδα δυσκολίας και άρα, πέτυχαν την επίλυση του προβλήματος της αυτόματης στάθμευσης.
## Εκπαιδεύσεις με τον αλγόριθμο SAC {#sec:training:sac}

### Επισκόπηση εκπαιδεύσεων {#sec:training:sac:overview}

Ο αλγόριθμος SAC ήταν ο πρώτος της κατηγορίας δράστη-κριτή που εξετάστηκε. Συνολικά, διεξήχθησαν 21 εκπαιδεύσεις του αλγορίθμου, οι οποίες διήρκησαν αθροιστικά 26 ημέρες, 13 ώρες και 26 λεπτά.

Μία ενδιαφέρουσα συμπεριφορά, που προέκυψε κατά τις εκπαιδεύσεις των πρακτόρων με τον αλγόριθμο SAC, ήταν η αδυναμία τους να μάθουν να παρκάρουν κινούμενοι προς τα εμπρός. Συγκεκριμένα, παρατηρήσαμε πως όταν στην αρχική θέση του αυτοκινήτου, αυτό ήταν στραμμένο με την πίσω μεριά του προς τη θέση στάθμευσης, τότε ο πράκτορας πάρκαρε πάντα με την όπισθεν. Αντίθετα, όταν στην αρχική θέση του αυτοκινήτου, αυτό ήταν στραμμένο με τη μπροστινή μεριά του προς τη θέση στάθμευσης ή έστω παράλληλα προς αυτήν, τότε ο πράκτορας έμενε ακίνητος. Προκειμένου να αντιμετωπιστεί αυτό το προβλήμα, προσθέσαμε στη συνάρτηση ανταμοιβής επιβράβευση, για την κίνηση του πράκτορα προς τα εμπρός. Πράγματι, με τον τρόπο αυτό, ο πράκτορας έμαθε να παρκάρει τόσο με την όπισθεν, όσο και προς τα εμπρός.

Ακόμα, αξίζει να γίνει αναφορά στη χρησιμότητα της τεχνικής FrameSkip, καθώς αυτή αποτέλεσε το κλειδί για την επιτυχία του πράκτορα, στα μεγαλύτερα επίπεδα δυσκολίας του παιχνιδιού. Συγκεκριμένα, εφαρμόσαμε FrameSkip 4 βημάτων και χρειάστηκε επίσης, να μεταβαλούμε σε 4 την παράμετρο `train_freq` της βιβλιοθήκης Stable-Baselines3, η οποία ορίζει το πλήθος των βημάτων εκπαίδευσης, που θα γίνουν πριν από κάθε ενημέρωση του πράκτορα.

Τέλος, κρίσιμη αποδείχθηκε η χρήση της τεχνικής Curriculum Learning, προκειμένου να επιτευχθούν καλά αποτελέσματα από τον αλγόριθμο, στο τελευταίο επίπεδο δυσκολίας του παιχνιδιού. Συγκεκριμένα, χωρίς την τεχνική αυτή, ο πράκτορας υιοθετούσε απλώς την υποβέλτιστη πολιτική του να κάνει τον γύρο του χάρτη.

### Καλύτερες εκπαιδεύσεις {#sec:training:sac:best-training}

Οι εκπαιδεύσεις ξεκίνησαν από το επίπεδο δυσκολίας 2, του οποίου η καλύτερη εκπαίδευση με τον αλγόριθμο SAC διακρίνεται στην *Εικόνα @fig:training:sac:best-training* με μπλε χρώμα (εκπαίδευση 7). Παρατηρούμε πως μετά από 7Μ steps, η γραφική του success rate συγκλίνει στο 80%.

Στη συνέχεια, χρησιμιποιήθηκαν οι ίδιες παράμετροι εκπαίδευσης για το επίπεδο δυσκολίας 3. Η καλύτερη εκπαίδευση σε αυτό το επίπεδο φαίνεται στην *Εικόνα @fig:training:sac:best-training* με ροζ χρώμα (εκπαίδευση 6Β). Παρατηρούμε πως μετά από 12Μ steps, το success rate προσεγγίζει το 100%.

Τέλος, για να πετύχει ο αλγόριθμος ικανοποιητικές επιδόσεις στο επίπεδο δυσκολίας 4, χρειάστηκε να εφαρμόσουμε Curriculum Learning με τον πράκτορα των 12M steps της εκπαίδευσης 6Β. Η εκπαίδευση αυτή εμφανίζεται στην *Εικόνα @fig:training:sac:best-training* με κόκκινο χρώμα (εκπαίδευση 10). Παρατηρούμε πως μετά από 8Μ steps, το success rate συγκλίνει στο 95%.

![Καλύτερες εκπαιδεύσεις του αλγορίθμου SAC: με μπλε χρώμα στο επίπεδο 2, με ροζ χρώμα στο επίπεδο 3 και με κόκκινο χρώμα στο επίπεδο 4.](5-training/figures/SAC-best-training.png){width=100% #fig:training:sac:best-training}

Επομένως, βλέπουμε πως οι πράκτορες του αλγορίθμου SAC έφτασαν σε υψηλά επίπεδα επιδόσεων, σε όλα τα επίπεδα δυσκολίας και άρα, πέτυχαν την επίλυση του προβλήματος της αυτόματης στάθμευσης.
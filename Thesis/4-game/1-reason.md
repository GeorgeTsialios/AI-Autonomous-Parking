## Αιτιολογία κατασκεύης παιχνιδιού {#sec:game:reason}

Σε αυτήν την Ενότητα, θα απαντήσουμε στο ερώτημα: «Γιατί να κατασκευάσουμε ένα παιχνίδι από το μηδέν;». Η απάντηση σε αυτό το ερώτημα θα διασαφηνίσει τον τρόπο σκέψης μας και θα εξηγήσει τις επιλογές που κάναμε. Παράλληλα, θα βοηθήσει τους ενδιαφερόμενους αναγνώστες να πάρουν τη δική τους απόφαση, γνωρίζοντας τα δεδομένα σε κάθε περίπτωση.

Μία πρώτη επιλογή είναι να χρησιμοποιήσουμε ένα παιχνίδι που έχει ήδη κατασκευαστεί. Για παράδειγμα, τα βίντεο του [@youtubeYosh], σχετικά με την εκπαίδευση πρακτόρων στο δημοφιλές παιχνίδι αγώνων ταχύτητας «Trackmania», ήταν από τα πρώτα που με εισήγαγαν στον τομέα της ενισχυτικής μάθησης. Ωστόσο, το κυριότερο πρόβλημα που παρουσιάζεται σε αυτήν την περίπτωση, είναι η επικοινωνία με το παιχνίδι. Συγκεκριμένα, ο πράκτορας πρέπει να δέχεται ως είσοδο την κατάσταση του παιχνιδιού και να επιστρέφει σε αυτό ως έξοδο την επιλεγμένη ενέργεια του. Κάποιοι αλγόριθμοι ενισχυτικής μάθησης, όπως ο DQN, είναι ικανοί να εκπαιδεύονται απευθείας από εικόνες (*raw pixels input*). Επομένως, θα ήταν απαραίτητη η ανάπτυξη ή χρήση ενός προγράμματος που θα δημιουργούσε ένα στιγμιότυπο της οθόνης του παιχνιδιού (*screen capture*) σε κάθε καρέ (*frame*), θα το μετέτρεπε σε ένα διάνυσμα από pixels και θα το έδινε ως είσοδο στον πράκτορα. Από την άλλη, έαν η είσοδος του αλγορίθμου είναι της μορφής διανύσματος χαρακτηριστικών του παιχνιδιού (*feature engineering*), τότε μπορεί να χρειαστεί κάποια εφαρμογή μηχανικής όρασης (*computer vision*) για να εξαχθούν αυτά τα δεδομένα. Αντίστοιχα, για την έξοδο του πράκτορα θα μπορούσε να χρησιμοποιηθεί κάποια βιβλιοθήκη όπως η PyAutoGU, για τον έλεγχο του ποντικιού και του πληκτρολογίου. Ακόμα, κάποια εμπορικά παιχνίδια διαθέτουν ειδικές διεπαφές (*APIs*) που επιτρέπουν την αλληλεπίδραση με εξωτερικά προγράμματα, δίνοντας τους πρόσβαση σε δεδομένα του παιχνιδιού (*game state data*). Αυτό είναι σαφώς πολύ χρήσιμο, όμως μπορεί να αποδειχθεί ανεπαρκές. Για παράδειγμα, στην *Εικόνα @fig:game:reason:Yosh* φαίνεται ο τρόπος επικοινωνίας με το παιχνίδι Trackmania, του προηγούμενου βίντεο.

![Επικοινωνία πράκτορα με το παιχνίδι Trackmania [@youtubeYosh].](4-game/figures/trackmania.png){#fig:game:reason:Yosh width=90%}

Στο αριστερό μέρος της *Εικόνας @fig:game:reason:Yosh* διακρίνεται η εικόνα του παιχνιδιού, όπως την βλέπουμε οι άνθρωποι. Στο δεξί μέρος, φαίνεται η επικοινωνία με το API του παιχνιδιού, για την είσοδο κι έξοδο του πράκτορα. Ωστόσο, όπως φαίνεται στο πάνω-δεξία μέρος της εικόνας, κρίθηκε απαραίτητη η δημιουργία ενός προγράμματος καταγραφής στιγμιοτύπων της οθόνης και μέτρησης της απόστασης του αυτοκινήτου από τους τοίχους της πίστας μέσα από αυτά. Επομένως, τα δεδομένα του API ήταν ανεπαρκή και για αυτό το λόγο αναπτύχθηκε ένα πρόγραμμα μηχανικής όρασης.

Με βάση τα παραπάνω, παρατηρούμε πως η χρήση ενός ήδη υπάρχοντος παιχνιδιού παρουσιάζει προκλήσεις και μπορεί να απαιτήσει προϋπάρχουσες γνώσεις σε τομείς, όπως η μηχανική όραση και η επεξεργασία εικόνας. Επίσης, δυσκολίες μπορεί να προκύψουν και σε μεταγενέστερα στάδια της εκπαίδευσης και οι όποιες αλλαγές ή λύσεις θα είναι δύσκολα εφαρμόσιμες.

Για όλους τους ανωτέρω λόγους, θεωρώ πως είναι προτιμότερο να χρησιμοποιηθεί ένα περιβάλλον ειδικό για την εκπαίδευση πρακτόρων, το οποίο θα έχει προβλέψει τις όποιες ανάγκες και θα παρέχει τα απαραίτητα εργαλεία. Η πιο διαδεδομένη πλατφόρμα αυτού του είδους, είναι το Gymnasium της OpenAI [brockman2016openaigym].

Η πλατφόρμα Gymnasium της OpenAI αποτελεί μία βιβλιοθήκη γραμμένη σε γλώσσα Python και είναι ένα σημαντικό εργαλείο για την έρευνα στον τομέα της ενισχυτικής μάθησης. Χρησιμοποιείται για την ανάπτυξη και σύγκριση αλγορίθμων ενισχυτικής μάθησης, παρέχοντας μια μεγάλη ποικιλία περιβαλλόντων, από απλές εργασίες όπως παιχνίδια της πλατφόρμας Atari εως σύνθετα προβλήματα ελέγχου όπως προσομοιώσεις ρομποτικών εφαρμογών. Η βιβλιοθήκη παρέχει μία απλή διεπαφή, με μία σειρά από υλοποιημένες συναρτήσεις, που επιτρέπουν την εύκολη εκπαίδευση και αξιολόγηση πρακτόρων ενισχυτικής μάθησης. Η βιβλιοθήκη είναι σήμερα εξαιρετικά δημοφιλής και χρησιμοποιείται σχεδόν σε κάθε εργασία ή άρθρο που αφορά την ενισχυτική μάθηση. Επομένως, μία απλή και αξιόπιστη λύση είναι η χρήση της βιβλιοθήκης OpenAI Gymnasium για την παροχή του περιβάλλοντος και όλων των απαραίτητων μεθόδων για την αλληλεπίδραση του πράκτορα με αυτό.

Ακόμα, η βιβλιοθήκη OpenAI Gymnasium, δίνει τη δυνατότητα δημιουργίας καινούργιων περιβάλλοντων εκπαίδευσης (*custom gymnasium environment*). Αυτό σημαίνει, πως μπορεί κάποιος να κατασκευάσει σε κώδικα ένα δικό του παιχνίδι και στη συνέχεια, να το μετατρέψει σε περιβάλλον συμβατό με τη βιβλιοθήκη. Η μετατροπή δεν περιλαμβάνει μεγάλες διαφορές, παρά μόνο την υλοποίηση ορισμένων μεθόδων και κλάσεων. Με τον τρόπο αυτό, θα είναι δυνατή η αξιοποίηση των πολύ χρήσιμων εργαλείων της βιβλιοθήκης, σε ένα δικό μας παιχνίδι. Αυτή ήταν και η επιλογή που προτιμήθηκε σε αυτήν την εργασία.

Συγκεκριμένα, κατασκευάστηκε ένα παιχνίδι σε γλώσσα Python, με χρήση της βιβλιοθήκης Pygame. Στη συνέχεια, ο κώδικας προσαρμόστηκε κατάλληλα, ώστε να μετατραπεί το παιχνίδι σε καινούργιο περιβάλλον εκπαίδευσης. Αυτή η διαδικασία παρέχει το βασικό πλεονέκτημα της εξοικείωσης με τον κώδικα του παιχνιδιού και της ελευθερίας αλλαγής του. Συγκεκριμένα, δεν υπάρχει κανένας περιορισμός στο πως θα εκφράζονται οι καταστάσεις του περιβάλλοντος ή ποιες θα είναι οι δυνατές ενέργειες του πράκτορα. Ακόμα, μπορεί το παιχνίδι να προσαρμοστεί στις ανάγκες της εκπαίδευσης, προσθέτοντας, αφαιρώντας ή τροποποιώντας χαρακτηριστικά του. Επομένως, η κατασκευή ενός παιχνιδιού από το μηδέν, παρέχει μία ευελιξία και ελευθερία κινήσεων και επιλογών, η οποία δεν προσφέρεται σε καμία άλλη περίπτωση. Ένα άλλο πλεονέκτημα, είναι πως η γλώσσα Python αποτελεί την πιο ευρέως χρησιμοποιούμενη γλώσσα προγραμματισμού στον τομέα της μηχανικής μάθησης. Συνεπώς, πέρα από τη συμβατότητα με τη βιβλιοθήκη OpenAI Gymnasium, ένα παιχνίδι γραμμένο σε Python παρέχει εύκολη συμβατότητα με δημοφιλείς βιβλιοθήκες αλγορίθμων μηχανικής μάθησης, όπως η TensorFlow και η PyTorch. Τέλος, είναι καλό να αναλογιστεί κανείς το υπολογιστικό κόστος της εκτέλεσης του παιχνιδιού. Συγκεκριμένα, οι αλγόριθμοι βαθιάς ενισχυτικής μάθησης είναι ιδιαίτερα κοστοβόροι και απαιτούν σημαντική επεξεργασία σε πόρους όπως ο επεξεργαστής (*CPU*) και η κάρτα γραφικών (*GPU*). Επομένως, είναι σημαντικό το παιχνίδι να είναι απλό και να μην προσθέτει μεγάλη επιβάρυνση στους υπολογιστικούς πόρους, όταν εκτελείται. Αυτό είναι ένα ακόμα πλεονέκτημα της χρήσης της βιβλιοθήκης Pygame, η οποία είναι ελαφριά και αποδοτική.

Για όλους τους παραπάνω λόγους, κρίθηκε προτιμότερη η κατασκευή ενός παιχνιδιού σε Python και, εκ των υστέρων, θα τη συνιστούσα ως η καλύτερη επιλογή για την εκπαίδευση πρακτόρων ενισχυτικής μάθησης. Παρόλα αυτά, αξίζει να αναφερθούμε σε δύο ενδιαφέρουσες, εναλλακτικές λύσεις.

Η πρώτη εναλλακτική επιλογή αφορά τη χρήση της μηχανής παιχνιδιών (*game engine*) Unity. Η Unity είναι μία ισχυρή μηχανή που επιτρέπει την κατασκευή παιχνιδιών σε 2 ή 3 διαστάσεις, μέσω της χρήσης της γραφικής διεπαφής της, καθώς και της συγγραφής αρχείων κώδικα (*scripts*) σε γλώσσα C#. Η βιβλιοθήκη Unity Machine Learning Agents είναι ένα έργο ανοιχτού κώδικα, που επιτρέπει τη δημιουργία περιβαλλόντων εκπαίδευσης για ευφυείς πράκτορες μηχανικής μάθησης. Μάλιστα, παρέχει έτοιμες μεθόδους, όπως υλοποιημένους αλγορίθμους ενισχυτικής μάθησης μέσω μίας διεπαφής σε γλώσσα Python. Επομένως, η κατασκευή ενός παιχνιδιού σε Unity και η εκπαίδευση μέσω της βιβλιοθήκης ML Agents, αποτελεί μία καλή εναλλακτική λύση και σίγουρα, το τελικό αποτέλεσμα θα είναι πιο εντυπωσιακό, όσον αφορά την αισθητική και την εμφάνιση του. Ωστόσο, η Unity είναι μία πολύπλοκη μηχανή και η εξοικείωση με αυτήν, καθώς και η κατασκευή ενός παιχνιδιού μέσω αυτής, απαιτεί σημαντικό χρόνο. Δεδομένου ότι η εκπαίδευση πρακτόρων ενισχυτικής μάθησης είναι ήδη μία δύσκολη και χρονοβόρα διαδικασία, είναι προτιμότερο να αφιερωθεί ικανός χρόνος σε αυτήν παρά στη δημιουργία ενός πιο ρεαλιστικού ή πιο όμορφου παιχνιδιού. Επομένως, ο στόχος της εργασίας είναι τέτοιος, ώστε η επιλογή αυτή να ήταν προτιμότερη, μόνο αν ο αναγνώστης είναι ήδη εξοικειωμένος με το περιβάλλον της Unity και τη γλώσσα C#. 

Η δεύτερη εναλλακτική λύση, είναι η χρήση ενός προγράμματος προσομοιωτή. Για την περίπτωση της αυτόνομης οδήγησης που εξετάζεται σε αυτήν την εργασία, δημοφιλή τέτοια περιβάλλοντα αποτελούν το TORCS (*The Open Racing Car Simulator*) και το Carla (*Car Learning to Act*). Υπάρχει πληθώρα δημοσιεύσεων μηχανικής μάθησης που χρησιμοποιούν αυτούς τους προσωμοιωτές.
Η χρήση τους παρέχει επιπλέον ρεαλισμό, με μηχανισμούς φυσικής για την ακριβή αναπαράσταση της κίνησης των οχημάτων και προσφέρει ποικιλία δυνατοτήτων, όπως η χρήση πραγματικών αισθητήτων διαφόρων ειδών (πχ κάμερες, LIDAR, GPS). Ακόμα, διατίθενται διαφορετικά σενάρια εκπαίδευσης με πολύπλοκες παραμέτρους του πραγματικού κόσμου, όπως φανάρια, διαβάσεις πεζών, κίνηση άλλων οχημάτων και δυσμενείς καιρικές συνθήκες. Επομένως, τα προγράμματα αυτά αποτελούν την ιδανική επιλογή για εκπαιδεύσεις με μεγάλη πιστότητα και ακρίβεια στην αναπαράσταση του πραγματικού κόσμου. Ωστόσο, η χρήση τους απαιτεί σημαντικούς υπολογιστικούς πόρους, όπως εξελιγμένες κάρτες γραφικών και μεγάλα ποσά μνήμης. Ακόμα, όπως και στην περίπτωση της Unity, η εξοικείωση με τα προγράμματα αυτά απαιτεί χρόνο και η δημιουργία ενός περιβάλλοντος εκπαίδευσης θα παρουσιάσει σημαντικές προκλήσεις σε έναν αρχάριο. 

Αν και αναγνωρίζονται τα πλεονεκτήματα της χρήσης αυτών των μεθόδων, για τους λόγους που εξηγήθηκαν παραπάνω, δεν επιλέχθηκαν στη συγκεκριμένη εργασία.

